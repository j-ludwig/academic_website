<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>20 Michigan Consumer Survey | Data Analysis for Economic Research</title>
  <meta name="description" content="20 Michigan Consumer Survey | Data Analysis for Economic Research" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="20 Michigan Consumer Survey | Data Analysis for Economic Research" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="20 Michigan Consumer Survey | Data Analysis for Economic Research" />
  
  
  



<meta name="date" content="2023-07-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="why-subjective-information-matters.html"/>
<link rel="next" href="real-time-and-forecaster-data.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="index.html">Data Analysis for Economic Research</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html"><i class="fa fa-check"></i><em>Preface</em></a>
<ul>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#introduction"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#author"><i class="fa fa-check"></i>Author</a></li>
<li class="chapter" data-level="" data-path="preface.html"><a href="preface.html#book-navigation"><i class="fa fa-check"></i>Book Navigation</a></li>
</ul></li>
<li class="part"><span><b>Module I</b></span></li>
<li class="chapter" data-level="" data-path="module-i.html"><a href="module-i.html"><i class="fa fa-check"></i><em>Introduction to R for Economic Research</em></a></li>
<li class="chapter" data-level="1" data-path="software-overview.html"><a href="software-overview.html"><i class="fa fa-check"></i><b>1</b> Software Overview</a></li>
<li class="chapter" data-level="2" data-path="software-installation.html"><a href="software-installation.html"><i class="fa fa-check"></i><b>2</b> Software Installation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="software-installation.html"><a href="software-installation.html#install-r"><i class="fa fa-check"></i><b>2.1</b> Install R</a></li>
<li class="chapter" data-level="2.2" data-path="software-installation.html"><a href="software-installation.html#install-rstudio"><i class="fa fa-check"></i><b>2.2</b> Install RStudio</a></li>
<li class="chapter" data-level="2.3" data-path="software-installation.html"><a href="software-installation.html#install-r-markdown"><i class="fa fa-check"></i><b>2.3</b> Install R Markdown</a></li>
<li class="chapter" data-level="2.4" data-path="software-installation.html"><a href="software-installation.html#install-latex"><i class="fa fa-check"></i><b>2.4</b> Install LaTeX</a></li>
<li class="chapter" data-level="2.5" data-path="software-installation.html"><a href="software-installation.html#install-r-packages"><i class="fa fa-check"></i><b>2.5</b> Install R Packages</a></li>
<li class="chapter" data-level="2.6" data-path="software-installation.html"><a href="software-installation.html#step-test"><i class="fa fa-check"></i><b>2.6</b> 18-Step Test</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="rstudio-interface.html"><a href="rstudio-interface.html"><i class="fa fa-check"></i><b>3</b> RStudio Interface</a>
<ul>
<li class="chapter" data-level="3.1" data-path="rstudio-interface.html"><a href="rstudio-interface.html#rstudio-sections"><i class="fa fa-check"></i><b>3.1</b> RStudio Sections</a></li>
<li class="chapter" data-level="3.2" data-path="rstudio-interface.html"><a href="rstudio-interface.html#r-scripts"><i class="fa fa-check"></i><b>3.2</b> R Scripts</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="r-data-types-and-structures.html"><a href="r-data-types-and-structures.html"><i class="fa fa-check"></i><b>4</b> R Data Types and Structures</a>
<ul>
<li class="chapter" data-level="4.1" data-path="r-data-types-and-structures.html"><a href="r-data-types-and-structures.html#scalar"><i class="fa fa-check"></i><b>4.1</b> Scalar</a></li>
<li class="chapter" data-level="4.2" data-path="r-data-types-and-structures.html"><a href="r-data-types-and-structures.html#vector"><i class="fa fa-check"></i><b>4.2</b> Vector</a></li>
<li class="chapter" data-level="4.3" data-path="r-data-types-and-structures.html"><a href="r-data-types-and-structures.html#matrix-matrix"><i class="fa fa-check"></i><b>4.3</b> Matrix (<code>matrix</code>)</a></li>
<li class="chapter" data-level="4.4" data-path="r-data-types-and-structures.html"><a href="r-data-types-and-structures.html#list-list"><i class="fa fa-check"></i><b>4.4</b> List (<code>list</code>)</a></li>
<li class="chapter" data-level="4.5" data-path="r-data-types-and-structures.html"><a href="r-data-types-and-structures.html#data.frame"><i class="fa fa-check"></i><b>4.5</b> Data Frame (<code>data.frame</code>)</a></li>
<li class="chapter" data-level="4.6" data-path="r-data-types-and-structures.html"><a href="r-data-types-and-structures.html#tibble"><i class="fa fa-check"></i><b>4.6</b> Tibble (<code>tbl_df</code>)</a></li>
<li class="chapter" data-level="4.7" data-path="r-data-types-and-structures.html"><a href="r-data-types-and-structures.html#data-table-data.table"><i class="fa fa-check"></i><b>4.7</b> Data Table (<code>data.table</code>)</a></li>
<li class="chapter" data-level="4.8" data-path="r-data-types-and-structures.html"><a href="r-data-types-and-structures.html#xts"><i class="fa fa-check"></i><b>4.8</b> Extensible Time Series (<code>xts</code>)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="importing-data-in-r.html"><a href="importing-data-in-r.html"><i class="fa fa-check"></i><b>5</b> Importing Data in R</a>
<ul>
<li class="chapter" data-level="5.1" data-path="importing-data-in-r.html"><a href="importing-data-in-r.html#working-directory"><i class="fa fa-check"></i><b>5.1</b> Working Directory</a></li>
<li class="chapter" data-level="5.2" data-path="importing-data-in-r.html"><a href="importing-data-in-r.html#yield-curve"><i class="fa fa-check"></i><b>5.2</b> Yield Curve</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="importing-data-in-r.html"><a href="importing-data-in-r.html#import-csv-file"><i class="fa fa-check"></i><b>5.2.1</b> Import CSV File</a></li>
<li class="chapter" data-level="5.2.2" data-path="importing-data-in-r.html"><a href="importing-data-in-r.html#plotting-historical-yields"><i class="fa fa-check"></i><b>5.2.2</b> Plotting Historical Yields</a></li>
<li class="chapter" data-level="5.2.3" data-path="importing-data-in-r.html"><a href="importing-data-in-r.html#plotting-yield-curve"><i class="fa fa-check"></i><b>5.2.3</b> Plotting Yield Curve</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="importing-data-in-r.html"><a href="importing-data-in-r.html#michigan-survey"><i class="fa fa-check"></i><b>5.3</b> Michigan Survey</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="importing-data-in-r.html"><a href="importing-data-in-r.html#import-tsv-file"><i class="fa fa-check"></i><b>5.3.1</b> Import TSV File</a></li>
<li class="chapter" data-level="5.3.2" data-path="importing-data-in-r.html"><a href="importing-data-in-r.html#plotting-consumer-indices"><i class="fa fa-check"></i><b>5.3.2</b> Plotting Consumer Indices</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="importing-data-in-r.html"><a href="importing-data-in-r.html#tealbook"><i class="fa fa-check"></i><b>5.4</b> Tealbook</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="importing-data-in-r.html"><a href="importing-data-in-r.html#import-excel-workbook"><i class="fa fa-check"></i><b>5.4.1</b> Import Excel Workbook</a></li>
<li class="chapter" data-level="5.4.2" data-path="importing-data-in-r.html"><a href="importing-data-in-r.html#nowcast-and-backcast"><i class="fa fa-check"></i><b>5.4.2</b> Nowcast and Backcast</a></li>
<li class="chapter" data-level="5.4.3" data-path="importing-data-in-r.html"><a href="importing-data-in-r.html#information-date-and-realization-date"><i class="fa fa-check"></i><b>5.4.3</b> Information Date and Realization Date</a></li>
<li class="chapter" data-level="5.4.4" data-path="importing-data-in-r.html"><a href="importing-data-in-r.html#plotting-forecasts"><i class="fa fa-check"></i><b>5.4.4</b> Plotting Forecasts</a></li>
<li class="chapter" data-level="5.4.5" data-path="importing-data-in-r.html"><a href="importing-data-in-r.html#plotting-forecast-errors"><i class="fa fa-check"></i><b>5.4.5</b> Plotting Forecast Errors</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="downloading-data-in-r.html"><a href="downloading-data-in-r.html"><i class="fa fa-check"></i><b>6</b> Downloading Data in R</a>
<ul>
<li class="chapter" data-level="6.1" data-path="downloading-data-in-r.html"><a href="downloading-data-in-r.html#web-api"><i class="fa fa-check"></i><b>6.1</b> Web API</a></li>
<li class="chapter" data-level="6.2" data-path="downloading-data-in-r.html"><a href="downloading-data-in-r.html#using-getsymbols"><i class="fa fa-check"></i><b>6.2</b> Using <code>getSymbols()</code></a></li>
<li class="chapter" data-level="6.3" data-path="downloading-data-in-r.html"><a href="downloading-data-in-r.html#using-quandl"><i class="fa fa-check"></i><b>6.3</b> Using <code>Quandl()</code></a></li>
<li class="chapter" data-level="6.4" data-path="downloading-data-in-r.html"><a href="downloading-data-in-r.html#saving-data"><i class="fa fa-check"></i><b>6.4</b> Saving Data</a></li>
<li class="chapter" data-level="6.5" data-path="downloading-data-in-r.html"><a href="downloading-data-in-r.html#summary-and-resources"><i class="fa fa-check"></i><b>6.5</b> Summary and Resources</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="writing-reports-with-r-markdown.html"><a href="writing-reports-with-r-markdown.html"><i class="fa fa-check"></i><b>7</b> Writing Reports with R Markdown</a>
<ul>
<li class="chapter" data-level="7.1" data-path="writing-reports-with-r-markdown.html"><a href="writing-reports-with-r-markdown.html#creating-an-r-markdown-document"><i class="fa fa-check"></i><b>7.1</b> Creating an R Markdown Document</a></li>
<li class="chapter" data-level="7.2" data-path="writing-reports-with-r-markdown.html"><a href="writing-reports-with-r-markdown.html#yaml-header"><i class="fa fa-check"></i><b>7.2</b> YAML Header</a></li>
<li class="chapter" data-level="7.3" data-path="writing-reports-with-r-markdown.html"><a href="writing-reports-with-r-markdown.html#markdown-syntax"><i class="fa fa-check"></i><b>7.3</b> Markdown Syntax</a></li>
<li class="chapter" data-level="7.4" data-path="writing-reports-with-r-markdown.html"><a href="writing-reports-with-r-markdown.html#r-chunks"><i class="fa fa-check"></i><b>7.4</b> R Chunks</a></li>
<li class="chapter" data-level="7.5" data-path="writing-reports-with-r-markdown.html"><a href="writing-reports-with-r-markdown.html#embedding-r-variables-into-text"><i class="fa fa-check"></i><b>7.5</b> Embedding R Variables into Text</a></li>
<li class="chapter" data-level="7.6" data-path="writing-reports-with-r-markdown.html"><a href="writing-reports-with-r-markdown.html#latex-syntax-for-math"><i class="fa fa-check"></i><b>7.6</b> LaTeX Syntax for Math</a></li>
<li class="chapter" data-level="7.7" data-path="writing-reports-with-r-markdown.html"><a href="writing-reports-with-r-markdown.html#printing-tables"><i class="fa fa-check"></i><b>7.7</b> Printing Tables</a></li>
<li class="chapter" data-level="7.8" data-path="writing-reports-with-r-markdown.html"><a href="writing-reports-with-r-markdown.html#summary-and-resources-1"><i class="fa fa-check"></i><b>7.8</b> Summary and Resources</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="learning-r-with-datacamp.html"><a href="learning-r-with-datacamp.html"><i class="fa fa-check"></i><b>8</b> Learning R with DataCamp</a>
<ul>
<li class="chapter" data-level="8.1" data-path="learning-r-with-datacamp.html"><a href="learning-r-with-datacamp.html#preparing-for-the-course"><i class="fa fa-check"></i><b>8.1</b> Preparing for the Course</a></li>
<li class="chapter" data-level="8.2" data-path="learning-r-with-datacamp.html"><a href="learning-r-with-datacamp.html#xp-system-and-course-completion"><i class="fa fa-check"></i><b>8.2</b> XP System and Course Completion</a></li>
<li class="chapter" data-level="8.3" data-path="learning-r-with-datacamp.html"><a href="learning-r-with-datacamp.html#developing-your-skills"><i class="fa fa-check"></i><b>8.3</b> Developing Your Skills</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="data-report-on-yield-curve.html"><a href="data-report-on-yield-curve.html"><i class="fa fa-check"></i><b>9</b> Data Report on Yield Curve</a>
<ul>
<li class="chapter" data-level="9.1" data-path="data-report-on-yield-curve.html"><a href="data-report-on-yield-curve.html#preparations"><i class="fa fa-check"></i><b>9.1</b> Preparations</a></li>
<li class="chapter" data-level="9.2" data-path="data-report-on-yield-curve.html"><a href="data-report-on-yield-curve.html#data-guidelines"><i class="fa fa-check"></i><b>9.2</b> Data Guidelines</a></li>
<li class="chapter" data-level="9.3" data-path="data-report-on-yield-curve.html"><a href="data-report-on-yield-curve.html#r-markdown-guidelines"><i class="fa fa-check"></i><b>9.3</b> R Markdown Guidelines</a></li>
</ul></li>
<li class="part"><span><b>Module II</b></span></li>
<li class="chapter" data-level="" data-path="module-ii.html"><a href="module-ii.html"><i class="fa fa-check"></i><em>Traditional Economic Indicators</em></a></li>
<li class="chapter" data-level="10" data-path="economic-indicators.html"><a href="economic-indicators.html"><i class="fa fa-check"></i><b>10</b> Economic Indicators</a></li>
<li class="chapter" data-level="11" data-path="data-categorization.html"><a href="data-categorization.html"><i class="fa fa-check"></i><b>11</b> Data Categorization</a>
<ul>
<li class="chapter" data-level="11.1" data-path="data-categorization.html"><a href="data-categorization.html#qualitative-vs.-quantitative"><i class="fa fa-check"></i><b>11.1</b> Qualitative vs. Quantitative</a></li>
<li class="chapter" data-level="11.2" data-path="data-categorization.html"><a href="data-categorization.html#discrete-vs.-continuous"><i class="fa fa-check"></i><b>11.2</b> Discrete vs. Continuous</a></li>
<li class="chapter" data-level="11.3" data-path="data-categorization.html"><a href="data-categorization.html#levels-of-measurement"><i class="fa fa-check"></i><b>11.3</b> Levels of Measurement</a>
<ul>
<li class="chapter" data-level="11.3.1" data-path="data-categorization.html"><a href="data-categorization.html#nominal-scale-variables"><i class="fa fa-check"></i><b>11.3.1</b> Nominal Scale Variables</a></li>
<li class="chapter" data-level="11.3.2" data-path="data-categorization.html"><a href="data-categorization.html#ordinal-scale-variables"><i class="fa fa-check"></i><b>11.3.2</b> Ordinal Scale Variables</a></li>
<li class="chapter" data-level="11.3.3" data-path="data-categorization.html"><a href="data-categorization.html#interval-scale-variables"><i class="fa fa-check"></i><b>11.3.3</b> Interval Scale Variables</a></li>
<li class="chapter" data-level="11.3.4" data-path="data-categorization.html"><a href="data-categorization.html#ratio-scale-variables"><i class="fa fa-check"></i><b>11.3.4</b> Ratio Scale Variables</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="data-categorization.html"><a href="data-categorization.html#index-vs.-absolute-data"><i class="fa fa-check"></i><b>11.4</b> Index vs. Absolute Data</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="data-categorization.html"><a href="data-categorization.html#index-data"><i class="fa fa-check"></i><b>11.4.1</b> Index Data</a></li>
<li class="chapter" data-level="11.4.2" data-path="data-categorization.html"><a href="data-categorization.html#absolute-data"><i class="fa fa-check"></i><b>11.4.2</b> Absolute Data</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="data-categorization.html"><a href="data-categorization.html#stock-vs.-flow"><i class="fa fa-check"></i><b>11.5</b> Stock vs. Flow</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="data-categorization.html"><a href="data-categorization.html#stock-variables"><i class="fa fa-check"></i><b>11.5.1</b> Stock Variables</a></li>
<li class="chapter" data-level="11.5.2" data-path="data-categorization.html"><a href="data-categorization.html#flow-variables"><i class="fa fa-check"></i><b>11.5.2</b> Flow Variables</a></li>
<li class="chapter" data-level="11.5.3" data-path="data-categorization.html"><a href="data-categorization.html#accounting"><i class="fa fa-check"></i><b>11.5.3</b> Accounting</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="data-categorization.html"><a href="data-categorization.html#data-dimensions"><i class="fa fa-check"></i><b>11.6</b> Data Dimensions</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="data-categorization.html"><a href="data-categorization.html#cross-sectional-data"><i class="fa fa-check"></i><b>11.6.1</b> Cross-Sectional Data</a></li>
<li class="chapter" data-level="11.6.2" data-path="data-categorization.html"><a href="data-categorization.html#time-series-data"><i class="fa fa-check"></i><b>11.6.2</b> Time Series Data</a></li>
<li class="chapter" data-level="11.6.3" data-path="data-categorization.html"><a href="data-categorization.html#panel-data"><i class="fa fa-check"></i><b>11.6.3</b> Panel Data</a></li>
<li class="chapter" data-level="11.6.4" data-path="data-categorization.html"><a href="data-categorization.html#spatial-data"><i class="fa fa-check"></i><b>11.6.4</b> Spatial Data</a></li>
<li class="chapter" data-level="11.6.5" data-path="data-categorization.html"><a href="data-categorization.html#clustered-data"><i class="fa fa-check"></i><b>11.6.5</b> Clustered Data</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="data-categorization.html"><a href="data-categorization.html#conclusion-data-categorization"><i class="fa fa-check"></i><b>11.7</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="data-transformation.html"><a href="data-transformation.html"><i class="fa fa-check"></i><b>12</b> Data Transformation</a>
<ul>
<li class="chapter" data-level="12.1" data-path="data-transformation.html"><a href="data-transformation.html#example-data"><i class="fa fa-check"></i><b>12.1</b> Example Data</a></li>
<li class="chapter" data-level="12.2" data-path="data-transformation.html"><a href="data-transformation.html#growth"><i class="fa fa-check"></i><b>12.2</b> Growth</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="data-transformation.html"><a href="data-transformation.html#definition-growth-rates"><i class="fa fa-check"></i><b>12.2.1</b> Definition</a></li>
<li class="chapter" data-level="12.2.2" data-path="data-transformation.html"><a href="data-transformation.html#log-approximation"><i class="fa fa-check"></i><b>12.2.2</b> Log Approximation</a></li>
<li class="chapter" data-level="12.2.3" data-path="data-transformation.html"><a href="data-transformation.html#relativity"><i class="fa fa-check"></i><b>12.2.3</b> Relativity</a></li>
<li class="chapter" data-level="12.2.4" data-path="data-transformation.html"><a href="data-transformation.html#return-and-inflation"><i class="fa fa-check"></i><b>12.2.4</b> Return and Inflation</a></li>
<li class="chapter" data-level="12.2.5" data-path="data-transformation.html"><a href="data-transformation.html#applicability-growth"><i class="fa fa-check"></i><b>12.2.5</b> Applicability</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="data-transformation.html"><a href="data-transformation.html#differentiation"><i class="fa fa-check"></i><b>12.3</b> Differentiation</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="data-transformation.html"><a href="data-transformation.html#definition-differentiation"><i class="fa fa-check"></i><b>12.3.1</b> Definition</a></li>
<li class="chapter" data-level="12.3.2" data-path="data-transformation.html"><a href="data-transformation.html#pp"><i class="fa fa-check"></i><b>12.3.2</b> Percentage Points (pp)</a></li>
<li class="chapter" data-level="12.3.3" data-path="data-transformation.html"><a href="data-transformation.html#bp"><i class="fa fa-check"></i><b>12.3.3</b> Basis Points (bp)</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="data-transformation.html"><a href="data-transformation.html#log"><i class="fa fa-check"></i><b>12.4</b> Natural Logarithm</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="data-transformation.html"><a href="data-transformation.html#definition-natural-logarithm"><i class="fa fa-check"></i><b>12.4.1</b> Definition</a></li>
<li class="chapter" data-level="12.4.2" data-path="data-transformation.html"><a href="data-transformation.html#motivation-natural-logarithm"><i class="fa fa-check"></i><b>12.4.2</b> Motivation</a></li>
<li class="chapter" data-level="12.4.3" data-path="data-transformation.html"><a href="data-transformation.html#applicability-natural-logarithm"><i class="fa fa-check"></i><b>12.4.3</b> Applicability</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="data-transformation.html"><a href="data-transformation.html#ratio"><i class="fa fa-check"></i><b>12.5</b> Ratio</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="data-transformation.html"><a href="data-transformation.html#definition-ratio"><i class="fa fa-check"></i><b>12.5.1</b> Definition</a></li>
<li class="chapter" data-level="12.5.2" data-path="data-transformation.html"><a href="data-transformation.html#per-capita"><i class="fa fa-check"></i><b>12.5.2</b> Per Capita</a></li>
<li class="chapter" data-level="12.5.3" data-path="data-transformation.html"><a href="data-transformation.html#real-vs.-nominal"><i class="fa fa-check"></i><b>12.5.3</b> Real vs. Nominal</a></li>
<li class="chapter" data-level="12.5.4" data-path="data-transformation.html"><a href="data-transformation.html#growth-of-ratios"><i class="fa fa-check"></i><b>12.5.4</b> Growth of Ratios</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="data-transformation.html"><a href="data-transformation.html#gap"><i class="fa fa-check"></i><b>12.6</b> Gap</a></li>
<li class="chapter" data-level="12.7" data-path="data-transformation.html"><a href="data-transformation.html#filtering"><i class="fa fa-check"></i><b>12.7</b> Filtering</a>
<ul>
<li class="chapter" data-level="12.7.1" data-path="data-transformation.html"><a href="data-transformation.html#frequency-filtering"><i class="fa fa-check"></i><b>12.7.1</b> Frequency Filtering</a></li>
<li class="chapter" data-level="12.7.2" data-path="data-transformation.html"><a href="data-transformation.html#detrending"><i class="fa fa-check"></i><b>12.7.2</b> Detrending</a></li>
<li class="chapter" data-level="12.7.3" data-path="data-transformation.html"><a href="data-transformation.html#seasonal-adjustment"><i class="fa fa-check"></i><b>12.7.3</b> Seasonal Adjustment</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="data-aggregation.html"><a href="data-aggregation.html"><i class="fa fa-check"></i><b>13</b> Data Aggregation</a></li>
<li class="chapter" data-level="14" data-path="data-source.html"><a href="data-source.html"><i class="fa fa-check"></i><b>14</b> Data Source</a>
<ul>
<li class="chapter" data-level="14.1" data-path="data-source.html"><a href="data-source.html#bureau-of-economic-analysis-bea"><i class="fa fa-check"></i><b>14.1</b> Bureau of Economic Analysis (BEA)</a></li>
<li class="chapter" data-level="14.2" data-path="data-source.html"><a href="data-source.html#u.s.-census-bureau"><i class="fa fa-check"></i><b>14.2</b> U.S. Census Bureau</a></li>
<li class="chapter" data-level="14.3" data-path="data-source.html"><a href="data-source.html#bureau-of-labor-statistics-bls"><i class="fa fa-check"></i><b>14.3</b> Bureau of Labor Statistics (BLS)</a></li>
<li class="chapter" data-level="14.4" data-path="data-source.html"><a href="data-source.html#federal-reserve-board-of-governors"><i class="fa fa-check"></i><b>14.4</b> Federal Reserve Board of Governors</a></li>
<li class="chapter" data-level="14.5" data-path="data-source.html"><a href="data-source.html#u.s.-department-of-the-treasury"><i class="fa fa-check"></i><b>14.5</b> U.S. Department of the Treasury</a></li>
<li class="chapter" data-level="14.6" data-path="data-source.html"><a href="data-source.html#financial-market-exchanges"><i class="fa fa-check"></i><b>14.6</b> Financial Market Exchanges</a></li>
<li class="chapter" data-level="14.7" data-path="data-source.html"><a href="data-source.html#federal-reserve-economic-data-fred"><i class="fa fa-check"></i><b>14.7</b> Federal Reserve Economic Data (FRED)</a></li>
<li class="chapter" data-level="14.8" data-path="data-source.html"><a href="data-source.html#u.s.-department-of-agriculture-economic-research-service-ers"><i class="fa fa-check"></i><b>14.8</b> U.S. Department of Agriculture Economic Research Service (ERS)</a></li>
<li class="chapter" data-level="14.9" data-path="data-source.html"><a href="data-source.html#bloomberg"><i class="fa fa-check"></i><b>14.9</b> Bloomberg</a></li>
<li class="chapter" data-level="14.10" data-path="data-source.html"><a href="data-source.html#yahoo-finance"><i class="fa fa-check"></i><b>14.10</b> Yahoo Finance</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="temporal-patterns.html"><a href="temporal-patterns.html"><i class="fa fa-check"></i><b>15</b> Temporal Patterns</a>
<ul>
<li class="chapter" data-level="15.1" data-path="temporal-patterns.html"><a href="temporal-patterns.html#time-series-data-1"><i class="fa fa-check"></i><b>15.1</b> Time Series Data</a>
<ul>
<li class="chapter" data-level="15.1.1" data-path="temporal-patterns.html"><a href="temporal-patterns.html#definition"><i class="fa fa-check"></i><b>15.1.1</b> Definition</a></li>
<li class="chapter" data-level="15.1.2" data-path="temporal-patterns.html"><a href="temporal-patterns.html#features"><i class="fa fa-check"></i><b>15.1.2</b> Features</a></li>
<li class="chapter" data-level="15.1.3" data-path="temporal-patterns.html"><a href="temporal-patterns.html#visualization"><i class="fa fa-check"></i><b>15.1.3</b> Visualization</a></li>
</ul></li>
<li class="chapter" data-level="15.2" data-path="temporal-patterns.html"><a href="temporal-patterns.html#trend"><i class="fa fa-check"></i><b>15.2</b> Trend</a>
<ul>
<li class="chapter" data-level="15.2.1" data-path="temporal-patterns.html"><a href="temporal-patterns.html#sustained-growth"><i class="fa fa-check"></i><b>15.2.1</b> Sustained Growth</a></li>
<li class="chapter" data-level="15.2.2" data-path="temporal-patterns.html"><a href="temporal-patterns.html#decrease-in-poverty"><i class="fa fa-check"></i><b>15.2.2</b> Decrease in Poverty</a></li>
<li class="chapter" data-level="15.2.3" data-path="temporal-patterns.html"><a href="temporal-patterns.html#aging-population"><i class="fa fa-check"></i><b>15.2.3</b> Aging Population</a></li>
<li class="chapter" data-level="15.2.4" data-path="temporal-patterns.html"><a href="temporal-patterns.html#productivity-labor-trade-off"><i class="fa fa-check"></i><b>15.2.4</b> Productivity-Labor Trade-Off</a></li>
<li class="chapter" data-level="15.2.5" data-path="temporal-patterns.html"><a href="temporal-patterns.html#trend-inflation"><i class="fa fa-check"></i><b>15.2.5</b> Trend Inflation</a></li>
<li class="chapter" data-level="15.2.6" data-path="temporal-patterns.html"><a href="temporal-patterns.html#decline-in-labor-share"><i class="fa fa-check"></i><b>15.2.6</b> Decline in Labor Share</a></li>
</ul></li>
<li class="chapter" data-level="15.3" data-path="temporal-patterns.html"><a href="temporal-patterns.html#seasonality"><i class="fa fa-check"></i><b>15.3</b> Seasonality</a>
<ul>
<li class="chapter" data-level="15.3.1" data-path="temporal-patterns.html"><a href="temporal-patterns.html#holiday-season"><i class="fa fa-check"></i><b>15.3.1</b> Holiday Season</a></li>
<li class="chapter" data-level="15.3.2" data-path="temporal-patterns.html"><a href="temporal-patterns.html#seasonal-weather"><i class="fa fa-check"></i><b>15.3.2</b> Seasonal Weather</a></li>
<li class="chapter" data-level="15.3.3" data-path="temporal-patterns.html"><a href="temporal-patterns.html#seasonal-employment"><i class="fa fa-check"></i><b>15.3.3</b> Seasonal Employment</a></li>
</ul></li>
<li class="chapter" data-level="15.4" data-path="temporal-patterns.html"><a href="temporal-patterns.html#business-cycle"><i class="fa fa-check"></i><b>15.4</b> Business Cycle</a>
<ul>
<li class="chapter" data-level="15.4.1" data-path="temporal-patterns.html"><a href="temporal-patterns.html#costs-of-business-cycles"><i class="fa fa-check"></i><b>15.4.1</b> Costs of Business Cycles</a></li>
<li class="chapter" data-level="15.4.2" data-path="temporal-patterns.html"><a href="temporal-patterns.html#cyclicality-and-timing"><i class="fa fa-check"></i><b>15.4.2</b> Cyclicality and Timing</a></li>
<li class="chapter" data-level="15.4.3" data-path="temporal-patterns.html"><a href="temporal-patterns.html#consumption-smoothing"><i class="fa fa-check"></i><b>15.4.3</b> Consumption Smoothing</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="16" data-path="regional-patterns.html"><a href="regional-patterns.html"><i class="fa fa-check"></i><b>16</b> Regional Patterns</a>
<ul>
<li class="chapter" data-level="16.1" data-path="regional-patterns.html"><a href="regional-patterns.html#county-level"><i class="fa fa-check"></i><b>16.1</b> County-Level</a></li>
<li class="chapter" data-level="16.2" data-path="regional-patterns.html"><a href="regional-patterns.html#state-level"><i class="fa fa-check"></i><b>16.2</b> State-Level</a></li>
<li class="chapter" data-level="16.3" data-path="regional-patterns.html"><a href="regional-patterns.html#country-level"><i class="fa fa-check"></i><b>16.3</b> Country-Level</a></li>
</ul></li>
<li class="chapter" data-level="17" data-path="causal-relationships.html"><a href="causal-relationships.html"><i class="fa fa-check"></i><b>17</b> Causal Relationships</a></li>
<li class="chapter" data-level="18" data-path="data-report-on-traditional-economic-indicators.html"><a href="data-report-on-traditional-economic-indicators.html"><i class="fa fa-check"></i><b>18</b> Data Report on Traditional Economic Indicators</a>
<ul>
<li class="chapter" data-level="18.1" data-path="data-report-on-traditional-economic-indicators.html"><a href="data-report-on-traditional-economic-indicators.html#preparations-2"><i class="fa fa-check"></i><b>18.1</b> Preparations</a></li>
<li class="chapter" data-level="18.2" data-path="data-report-on-traditional-economic-indicators.html"><a href="data-report-on-traditional-economic-indicators.html#data-guidelines-2"><i class="fa fa-check"></i><b>18.2</b> Data Guidelines</a></li>
<li class="chapter" data-level="18.3" data-path="data-report-on-traditional-economic-indicators.html"><a href="data-report-on-traditional-economic-indicators.html#r-markdown-guidelines-2"><i class="fa fa-check"></i><b>18.3</b> R Markdown Guidelines</a></li>
</ul></li>
<li class="part"><span><b>Module III</b></span></li>
<li class="chapter" data-level="" data-path="module-iii.html"><a href="module-iii.html"><i class="fa fa-check"></i><em>Survey- and Text-Based Economic Indicators</em></a></li>
<li class="chapter" data-level="19" data-path="why-subjective-information-matters.html"><a href="why-subjective-information-matters.html"><i class="fa fa-check"></i><b>19</b> Why Subjective Information Matters</a></li>
<li class="chapter" data-level="20" data-path="michigan-consumer-survey.html"><a href="michigan-consumer-survey.html"><i class="fa fa-check"></i><b>20</b> Michigan Consumer Survey</a>
<ul>
<li class="chapter" data-level="20.1" data-path="michigan-consumer-survey.html"><a href="michigan-consumer-survey.html#introduction-1"><i class="fa fa-check"></i><b>20.1</b> Introduction</a></li>
<li class="chapter" data-level="20.2" data-path="michigan-consumer-survey.html"><a href="michigan-consumer-survey.html#conducting-the-survey"><i class="fa fa-check"></i><b>20.2</b> Conducting the Survey</a></li>
<li class="chapter" data-level="20.3" data-path="michigan-consumer-survey.html"><a href="michigan-consumer-survey.html#michigan-consumer-indices"><i class="fa fa-check"></i><b>20.3</b> Michigan Consumer Indices</a>
<ul>
<li class="chapter" data-level="20.3.1" data-path="michigan-consumer-survey.html"><a href="michigan-consumer-survey.html#index-of-consumer-sentiment-ics"><i class="fa fa-check"></i><b>20.3.1</b> Index of Consumer Sentiment (ICS)</a></li>
<li class="chapter" data-level="20.3.2" data-path="michigan-consumer-survey.html"><a href="michigan-consumer-survey.html#index-of-current-economic-conditions-icc"><i class="fa fa-check"></i><b>20.3.2</b> Index of Current Economic Conditions (ICC)</a></li>
<li class="chapter" data-level="20.3.3" data-path="michigan-consumer-survey.html"><a href="michigan-consumer-survey.html#index-of-consumer-expectations-ice"><i class="fa fa-check"></i><b>20.3.3</b> Index of Consumer Expectations (ICE)</a></li>
<li class="chapter" data-level="20.3.4" data-path="michigan-consumer-survey.html"><a href="michigan-consumer-survey.html#importing-in-r"><i class="fa fa-check"></i><b>20.3.4</b> Importing in R</a></li>
</ul></li>
<li class="chapter" data-level="20.4" data-path="michigan-consumer-survey.html"><a href="michigan-consumer-survey.html#creating-custom-consumer-indices"><i class="fa fa-check"></i><b>20.4</b> Creating Custom Consumer Indices</a></li>
<li class="chapter" data-level="20.5" data-path="michigan-consumer-survey.html"><a href="michigan-consumer-survey.html#importing-and-cleaning-individual-level-surveys"><i class="fa fa-check"></i><b>20.5</b> Importing and Cleaning Individual-Level Surveys</a>
<ul>
<li class="chapter" data-level="20.5.1" data-path="michigan-consumer-survey.html"><a href="michigan-consumer-survey.html#data-source-1"><i class="fa fa-check"></i><b>20.5.1</b> Data Source</a></li>
<li class="chapter" data-level="20.5.2" data-path="michigan-consumer-survey.html"><a href="michigan-consumer-survey.html#data-labels"><i class="fa fa-check"></i><b>20.5.2</b> Data Labels</a></li>
<li class="chapter" data-level="20.5.3" data-path="michigan-consumer-survey.html"><a href="michigan-consumer-survey.html#importing-the-data-set"><i class="fa fa-check"></i><b>20.5.3</b> Importing the Data Set</a></li>
<li class="chapter" data-level="20.5.4" data-path="michigan-consumer-survey.html"><a href="michigan-consumer-survey.html#long-format"><i class="fa fa-check"></i><b>20.5.4</b> Long Format</a></li>
<li class="chapter" data-level="20.5.5" data-path="michigan-consumer-survey.html"><a href="michigan-consumer-survey.html#saving-the-data"><i class="fa fa-check"></i><b>20.5.5</b> Saving the Data</a></li>
</ul></li>
<li class="chapter" data-level="20.6" data-path="michigan-consumer-survey.html"><a href="michigan-consumer-survey.html#exploring-individual-level-data"><i class="fa fa-check"></i><b>20.6</b> Exploring Individual-Level Data</a></li>
<li class="chapter" data-level="20.7" data-path="michigan-consumer-survey.html"><a href="michigan-consumer-survey.html#replicate-ics"><i class="fa fa-check"></i><b>20.7</b> Replicate ICS</a></li>
<li class="chapter" data-level="20.8" data-path="michigan-consumer-survey.html"><a href="michigan-consumer-survey.html#conclusion"><i class="fa fa-check"></i><b>20.8</b> Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="21" data-path="real-time-and-forecaster-data.html"><a href="real-time-and-forecaster-data.html"><i class="fa fa-check"></i><b>21</b> Real-Time and Forecaster Data</a></li>
<li class="chapter" data-level="22" data-path="text-based-economic-indicators.html"><a href="text-based-economic-indicators.html"><i class="fa fa-check"></i><b>22</b> Text-Based Economic Indicators</a></li>
<li class="chapter" data-level="23" data-path="data-report-on-survey--and-text-based-economic-indicators.html"><a href="data-report-on-survey--and-text-based-economic-indicators.html"><i class="fa fa-check"></i><b>23</b> Data Report on Survey- and Text-Based Economic Indicators</a>
<ul>
<li class="chapter" data-level="23.1" data-path="data-report-on-survey--and-text-based-economic-indicators.html"><a href="data-report-on-survey--and-text-based-economic-indicators.html#preparations-3"><i class="fa fa-check"></i><b>23.1</b> Preparations</a></li>
<li class="chapter" data-level="23.2" data-path="data-report-on-survey--and-text-based-economic-indicators.html"><a href="data-report-on-survey--and-text-based-economic-indicators.html#data-guidelines-3"><i class="fa fa-check"></i><b>23.2</b> Data Guidelines</a></li>
<li class="chapter" data-level="23.3" data-path="data-report-on-survey--and-text-based-economic-indicators.html"><a href="data-report-on-survey--and-text-based-economic-indicators.html#r-markdown-guidelines-3"><i class="fa fa-check"></i><b>23.3</b> R Markdown Guidelines</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://www.julianfludwig.com/" target="blank">Julian F. Ludwig</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Analysis for Economic Research</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="michigan-consumer-survey" class="section level1 hasAnchor" number="20">
<h1><span class="header-section-number">20</span> Michigan Consumer Survey<a href="michigan-consumer-survey.html#michigan-consumer-survey" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-1" class="section level2 hasAnchor" number="20.1">
<h2><span class="header-section-number">20.1</span> Introduction<a href="michigan-consumer-survey.html#introduction-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The University of Michigan’s Survey of Consumers has been capturing the mood of U.S. households about the economy since the late 1940s. The monthly survey captures U.S. households’ views about the economy, providing essential insights into their perceptions and attitudes towards the U.S. economic landscape. The surveys play a significant role in shaping economic and policy decisions, given that consumer spending accounts for approximately 70% of the U.S. economy.</p>
<p>The University of Michigan combines the survey into three key indices: the Index of Consumer Sentiment (ICS), the Index of Current Economic Conditions (ICC), and the Index of Consumer Expectations (ICE). The ICS, frequently cited in newspapers, economic studies, and financial reports, provides a comprehensive view of consumer confidence every month. The ICC concentrates on consumer attitudes towards the current economic environment, while the ICE forecasts future economic conditions.</p>
<p>These famous consumer indices are based on just five out of the survey’s fifty questions. This chapter not only explains how the ICS, ICC, and ICE are made, but also looks at the rest of the survey data to create new consumer indices.</p>
</div>
<div id="conducting-the-survey" class="section level2 hasAnchor" number="20.2">
<h2><span class="header-section-number">20.2</span> Conducting the Survey<a href="michigan-consumer-survey.html#conducting-the-survey" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Detailed information about the University of Michigan’s Surveys of Consumers is readily accessible on their official website at <a href="https://data.sca.isr.umich.edu" target="_blank">data.sca.isr.umich.edu</a>. The <a href="https://data.sca.isr.umich.edu/survey-info.php#" target="_blank">survey information</a> section of the website provides critical details about the survey process. This includes a thorough <a href="https://data.sca.isr.umich.edu/fetchdoc.php?docid=24774" target="_blank">survey description</a>, an overview of the <a href="https://data.sca.isr.umich.edu/fetchdoc.php?docid=57449" target="_blank">sample design</a>, and the actual <a href="https://data.sca.isr.umich.edu/fetchdoc.php?docid=24776" target="_blank">questionnaire</a> used in the survey. Below is some of the information summarized.</p>
<p><strong>Sample Population</strong></p>
<p>The Surveys of Consumers samples adults 18 years of age and older residing in households in the continental U.S. It’s designed to be a representative sample of all such households.</p>
<p><strong>Sampling Method</strong></p>
<p>The survey uses a rotating panel design, with a new panel of respondents each month, selected to reflect the demographic and geographic distribution of the U.S. population.</p>
<p><strong>Data Collection</strong></p>
<p>Telephone interviews are the primary mode of data collection, although they have been increasingly integrating web-based interviews in recent years. Interviews typically last about 15 minutes.</p>
<p><strong>Survey Questions</strong></p>
<p>The survey consists of approximately 50 core questions, and the rest of the questionnaire can vary depending on current economic events. The core questions elicit information on respondents’ financial situation, buying attitudes, and expectations about future economic conditions.</p>
<p><strong>Survey Frequency and Timing</strong></p>
<p>Starting from the late 1940s, the Surveys of Consumers were initially conducted quarterly. However, since the mid-1970s, the frequency has increased to monthly. Each month’s survey involves about 500 interviews, with roughly 50-60% completed by the 10th of the month. Preliminary results are released mid-month, with remaining interviews completed by month-end. Final results are published at the beginning of the following month.</p>
</div>
<div id="michigan-consumer-indices" class="section level2 hasAnchor" number="20.3">
<h2><span class="header-section-number">20.3</span> Michigan Consumer Indices<a href="michigan-consumer-survey.html#michigan-consumer-indices" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="index-of-consumer-sentiment-ics" class="section level3 hasAnchor" number="20.3.1">
<h3><span class="header-section-number">20.3.1</span> Index of Consumer Sentiment (ICS)<a href="michigan-consumer-survey.html#index-of-consumer-sentiment-ics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The ICS is a composite index that captures consumers’ perceptions of their financial situation and attitudes about the economy in general. It is derived from five questions related to personal finances, general economic conditions, and purchasing conditions.</p>
<p>To calculate the Index of Consumer Sentiment (ICS), we first compute the relative scores for each of the five index questions (<span class="math inline">\(x_1,...,x_5\)</span> listed below). The relative score is the percent of favorable replies minus the percent of unfavorable replies, with 100 added. Each relative score is then rounded to the nearest whole number. The ICS is calculated using the following formula:</p>
<p><span class="math display">\[
ICS = \frac{x_1+x_2+x_3+x_4+x_5}{6.7558} + 2.0
\]</span></p>
<p>The constant 2.0 is added to correct for sample design changes from the 1950s.</p>
<p>The ICS is derived from the responses to the following five questions:</p>
<ul>
<li><p><span class="math inline">\(x_1\)</span> = PAGO_R: “We are interested in how people are getting along financially these days. Would you say that you (and your family living there) are better off or worse off financially than you were a year ago?”</p></li>
<li><p><span class="math inline">\(x_2\)</span> = PEXP_R: “Now looking ahead–do you think that a year from now you (and your family living there) will be better off financially, or worse off, or just about the same as now?”</p></li>
<li><p><span class="math inline">\(x_3\)</span> = BUS12_R: “Now turning to business conditions in the country as a whole–do you think that during the next twelve months we’ll have good times financially, or bad times, or what?”</p></li>
<li><p><span class="math inline">\(x_4\)</span> = BUS5_R: “Looking ahead, which would you say is more likely–that in the country as a whole we’ll have continuous good times during the next five years or so, or that we will have periods of widespread unemployment or depression, or what?”</p></li>
<li><p><span class="math inline">\(x_5\)</span> = DUR_R: “About the big things people buy for their homes–such as furniture, a refrigerator, stove, television, and things like that. Generally speaking, do you think now is a good or bad time for people to buy major household items?”</p></li>
</ul>
<p>The responses to these questions are combined to create the indices. For each question, there are a certain number of points assigned for positive, neutral, and negative responses. After the responses are scored, they are combined to create each index. The indices are then normalized to a base year (currently 1966 = 100) to create the final index values.</p>
</div>
<div id="index-of-current-economic-conditions-icc" class="section level3 hasAnchor" number="20.3.2">
<h3><span class="header-section-number">20.3.2</span> Index of Current Economic Conditions (ICC)<a href="michigan-consumer-survey.html#index-of-current-economic-conditions-icc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The ICC specifically focuses on consumers’ perceptions of their current financial situation and whether it’s a good time to buy big-ticket items like cars and homes. It is based on responses to just two questions.</p>
<p>The ICC is constructed from questions 1 and 5 from the ICS list using the following formula:
<span class="math display">\[
ICC = \frac{x_1+x_5}{2.6424} + 2.0, \qquad
\]</span></p>
</div>
<div id="index-of-consumer-expectations-ice" class="section level3 hasAnchor" number="20.3.3">
<h3><span class="header-section-number">20.3.3</span> Index of Consumer Expectations (ICE)<a href="michigan-consumer-survey.html#index-of-consumer-expectations-ice" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The ICE aims to gauge consumer expectations for the future, specifically regarding their financial situation, general economic conditions, and purchasing conditions in the next year and next five years. It is derived from the remaining three questions.</p>
<p>The ICE is constructed from questions 2, 3, and 4 from the ICS list using the following formula:
<span class="math display">\[
ICE = \frac{x_2+x_3+x_4}{4.1134} + 2.0
\]</span></p>
</div>
<div id="importing-in-r" class="section level3 hasAnchor" number="20.3.4">
<h3><span class="header-section-number">20.3.4</span> Importing in R<a href="michigan-consumer-survey.html#importing-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Chapter <a href="importing-data-in-r.html#michigan-survey">5.3</a> illustrates how to import the three consumer indices, in addition to a selection of time series, which include the five that form the ICS, ICE, and ICC. For detailed descriptions of these time series, please refer to the <a href="https://data.sca.isr.umich.edu/fetchdoc.php?docid=45121" target="_blank">Time-Series Variable Codebook</a> provided on the survey’s website.</p>
</div>
</div>
<div id="creating-custom-consumer-indices" class="section level2 hasAnchor" number="20.4">
<h2><span class="header-section-number">20.4</span> Creating Custom Consumer Indices<a href="michigan-consumer-survey.html#creating-custom-consumer-indices" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>While the ICC, ICE, and ICS are the most well-known indices generated from the Michigan Consumer Survey data, researchers and analysts can create custom indices based on their specific interests. These custom indices might focus on specific demographics, geographic regions, or consumer attitudes about specific sectors of the economy.</p>
<p>Consider, for example, an index that captures consumers’ attitudes towards the housing market. This could be particularly useful for real estate investors and homebuilders. Such an index could be created by focusing on survey questions about consumers’ perceptions of current housing prices, their expectations for future housing prices, and their perceptions of the current home buying conditions.</p>
<p>The simplest way to create a new index is by combining several time series from the <a href="https://data.sca.isr.umich.edu/fetchdoc.php?docid=45121" target="_blank">Time-Series Variable Codebook</a> (see Chapter <a href="importing-data-in-r.html#michigan-survey">5.3</a> on how to import this data in R). These time series aggregate individual responses into a single observation per time period.</p>
<p>A more advanced approach to creating a new index involves working with the raw individual-level surveys then turning them into an index. This method allows for insights into the degree of disagreement among consumers, rather than just looking at averages. The next sections will explain how to work with these individual surveys and form them into time series.</p>
</div>
<div id="importing-and-cleaning-individual-level-surveys" class="section level2 hasAnchor" number="20.5">
<h2><span class="header-section-number">20.5</span> Importing and Cleaning Individual-Level Surveys<a href="michigan-consumer-survey.html#importing-and-cleaning-individual-level-surveys" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this chapter, we will go through the process of importing and cleaning the individual-level Michigan Consumer Survey data. This process involves downloading the raw data, importing the required R packages, importing data labels, making them tidy, and finally cleaning the data set. Let’s get started.</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="michigan-consumer-survey.html#cb331-1" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb331-2"><a href="michigan-consumer-survey.html#cb331-2" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb331-3"><a href="michigan-consumer-survey.html#cb331-3" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;xml2&quot;</span>)</span></code></pre></div>
<div id="data-source-1" class="section level3 hasAnchor" number="20.5.1">
<h3><span class="header-section-number">20.5.1</span> Data Source<a href="michigan-consumer-survey.html#data-source-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The data for this analysis is obtained from the University of Michigan Consumer Survey website. Follow the steps below to get the links:</p>
<ul>
<li>Visit <a href="https://data.sca.isr.umich.edu/" target="_blank">data.sca.isr.umich.edu</a></li>
<li>Click on “Data” - “Downloads” - “Cross-Section Archive”</li>
<li>Click “CSV file (Comma Separated Values with header record)” and “DDI (XML)”</li>
<li>Select “All” everywhere and click “continue”</li>
<li>Click “Create the Files”</li>
<li>Right click on the “Data file”, copy link, and save the link as <code>data_file</code></li>
<li>Right click on the “DDI XML file”, copy link, and save the link as <code>data_label_file</code></li>
</ul>
<p>Here are the direct links used in this example:</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="michigan-consumer-survey.html#cb332-1" tabindex="-1"></a>data_file <span class="ot">&lt;-</span> <span class="st">&quot;https://sda.umsurvey.org/tmpdir/AAcZmZrm.csv&quot;</span></span>
<span id="cb332-2"><a href="michigan-consumer-survey.html#cb332-2" tabindex="-1"></a>data_label_file <span class="ot">&lt;-</span> <span class="st">&quot;https://sda.umsurvey.org/tmpdir/AAIPR4qc.txt&quot;</span></span></code></pre></div>
</div>
<div id="data-labels" class="section level3 hasAnchor" number="20.5.2">
<h3><span class="header-section-number">20.5.2</span> Data Labels<a href="michigan-consumer-survey.html#data-labels" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First, we import the labels and convert them into a tidy format, ready for analysis. This involves converting the imported list to a tibble and tidying up the labels.</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb333-1"><a href="michigan-consumer-survey.html#cb333-1" tabindex="-1"></a><span class="co">#================================================================================================</span></span>
<span id="cb333-2"><a href="michigan-consumer-survey.html#cb333-2" tabindex="-1"></a><span class="co"># Data Labels</span></span>
<span id="cb333-3"><a href="michigan-consumer-survey.html#cb333-3" tabindex="-1"></a><span class="co">#================================================================================================</span></span>
<span id="cb333-4"><a href="michigan-consumer-survey.html#cb333-4" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------------------------</span></span>
<span id="cb333-5"><a href="michigan-consumer-survey.html#cb333-5" tabindex="-1"></a><span class="co"># Import labels</span></span>
<span id="cb333-6"><a href="michigan-consumer-survey.html#cb333-6" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------------------------</span></span>
<span id="cb333-7"><a href="michigan-consumer-survey.html#cb333-7" tabindex="-1"></a>raw_labels_list <span class="ot">&lt;-</span> <span class="fu">read_xml</span>(data_label_file) <span class="sc">%&gt;%</span> as_list <span class="sc">%&gt;%</span> as_tibble</span>
<span id="cb333-8"><a href="michigan-consumer-survey.html#cb333-8" tabindex="-1"></a></span>
<span id="cb333-9"><a href="michigan-consumer-survey.html#cb333-9" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------------------------</span></span>
<span id="cb333-10"><a href="michigan-consumer-survey.html#cb333-10" tabindex="-1"></a><span class="co"># Make labels tidy</span></span>
<span id="cb333-11"><a href="michigan-consumer-survey.html#cb333-11" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------------------------</span></span>
<span id="cb333-12"><a href="michigan-consumer-survey.html#cb333-12" tabindex="-1"></a><span class="co"># Convert list to tibble</span></span>
<span id="cb333-13"><a href="michigan-consumer-survey.html#cb333-13" tabindex="-1"></a>raw_labels <span class="ot">&lt;-</span> raw_labels_list <span class="sc">%&gt;%</span> </span>
<span id="cb333-14"><a href="michigan-consumer-survey.html#cb333-14" tabindex="-1"></a>    <span class="fu">unnest_longer</span>(codeBook, <span class="at">indices_to =</span> <span class="st">&quot;folder&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb333-15"><a href="michigan-consumer-survey.html#cb333-15" tabindex="-1"></a>    <span class="fu">filter</span>(folder <span class="sc">==</span> <span class="st">&quot;var&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb333-16"><a href="michigan-consumer-survey.html#cb333-16" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="at">index =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb333-17"><a href="michigan-consumer-survey.html#cb333-17" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">modify_in</span>(codeBook, <span class="fu">list</span>(<span class="dv">1</span>), attributes)) <span class="sc">%&gt;%</span> </span>
<span id="cb333-18"><a href="michigan-consumer-survey.html#cb333-18" tabindex="-1"></a>    <span class="fu">unnest_wider</span>(variable) <span class="sc">%&gt;%</span> </span>
<span id="cb333-19"><a href="michigan-consumer-survey.html#cb333-19" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>names, <span class="sc">-</span>folder) <span class="sc">%&gt;%</span></span>
<span id="cb333-20"><a href="michigan-consumer-survey.html#cb333-20" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb333-21"><a href="michigan-consumer-survey.html#cb333-21" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>index) <span class="sc">%&gt;%</span> </span>
<span id="cb333-22"><a href="michigan-consumer-survey.html#cb333-22" tabindex="-1"></a>    <span class="fu">unnest_longer</span>(codeBook, <span class="at">values_to =</span> <span class="st">&quot;value_as_list&quot;</span>, <span class="at">indices_to =</span> <span class="st">&quot;feature&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb333-23"><a href="michigan-consumer-survey.html#cb333-23" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">name =</span> <span class="fu">factor</span>(name, <span class="at">levels =</span> <span class="fu">unique</span>(name), <span class="at">ordered =</span> <span class="cn">TRUE</span>),</span>
<span id="cb333-24"><a href="michigan-consumer-survey.html#cb333-24" tabindex="-1"></a>           <span class="at">feature =</span> <span class="fu">factor</span>(feature, <span class="at">levels =</span> <span class="fu">unique</span>(feature), <span class="at">ordered =</span> <span class="cn">TRUE</span>))</span>
<span id="cb333-25"><a href="michigan-consumer-survey.html#cb333-25" tabindex="-1"></a></span>
<span id="cb333-26"><a href="michigan-consumer-survey.html#cb333-26" tabindex="-1"></a><span class="co"># Extract unnamed vs. named list elements</span></span>
<span id="cb333-27"><a href="michigan-consumer-survey.html#cb333-27" tabindex="-1"></a>raw_labels <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb333-28"><a href="michigan-consumer-survey.html#cb333-28" tabindex="-1"></a>    <span class="co"># unnamed list elements</span></span>
<span id="cb333-29"><a href="michigan-consumer-survey.html#cb333-29" tabindex="-1"></a>    raw_labels <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">lengths</span>(value_as_list) <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb333-30"><a href="michigan-consumer-survey.html#cb333-30" tabindex="-1"></a>        <span class="fu">unnest_wider</span>(value_as_list, <span class="at">transform =</span> as.character),</span>
<span id="cb333-31"><a href="michigan-consumer-survey.html#cb333-31" tabindex="-1"></a>    <span class="co"># named list elements</span></span>
<span id="cb333-32"><a href="michigan-consumer-survey.html#cb333-32" tabindex="-1"></a>    raw_labels <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">lengths</span>(value_as_list) <span class="sc">&lt;=</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span></span>
<span id="cb333-33"><a href="michigan-consumer-survey.html#cb333-33" tabindex="-1"></a>        <span class="fu">hoist</span>(value_as_list, <span class="at">labl =</span> <span class="fu">list</span>(<span class="dv">1</span>, <span class="dv">1</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb333-34"><a href="michigan-consumer-survey.html#cb333-34" tabindex="-1"></a>        <span class="fu">select</span>(<span class="sc">-</span>value_as_list)) <span class="sc">%&gt;%</span> </span>
<span id="cb333-35"><a href="michigan-consumer-survey.html#cb333-35" tabindex="-1"></a>    <span class="co"># back to original order</span></span>
<span id="cb333-36"><a href="michigan-consumer-survey.html#cb333-36" tabindex="-1"></a>    <span class="fu">arrange</span>(name, feature)</span>
<span id="cb333-37"><a href="michigan-consumer-survey.html#cb333-37" tabindex="-1"></a></span>
<span id="cb333-38"><a href="michigan-consumer-survey.html#cb333-38" tabindex="-1"></a><span class="co"># Remove &quot;\n&quot; and spaces</span></span>
<span id="cb333-39"><a href="michigan-consumer-survey.html#cb333-39" tabindex="-1"></a>raw_labels <span class="ot">&lt;-</span> raw_labels <span class="sc">%&gt;%</span></span>
<span id="cb333-40"><a href="michigan-consumer-survey.html#cb333-40" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">&quot;labl&quot;</span>, <span class="st">&quot;catValu&quot;</span>, <span class="st">&quot;txt&quot;</span>), </span>
<span id="cb333-41"><a href="michigan-consumer-survey.html#cb333-41" tabindex="-1"></a>                  <span class="cf">function</span>(x) <span class="fu">str_trim</span>(<span class="fu">str_remove_all</span>(x, <span class="st">&quot;</span><span class="sc">\\\\</span><span class="st">n&quot;</span>))),</span>
<span id="cb333-42"><a href="michigan-consumer-survey.html#cb333-42" tabindex="-1"></a>           <span class="at">dcml =</span> <span class="fu">as.integer</span>(dcml),</span>
<span id="cb333-43"><a href="michigan-consumer-survey.html#cb333-43" tabindex="-1"></a>           <span class="at">catValu =</span> <span class="fu">as.integer</span>(catValu))</span>
<span id="cb333-44"><a href="michigan-consumer-survey.html#cb333-44" tabindex="-1"></a></span>
<span id="cb333-45"><a href="michigan-consumer-survey.html#cb333-45" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------------------------</span></span>
<span id="cb333-46"><a href="michigan-consumer-survey.html#cb333-46" tabindex="-1"></a><span class="co"># Rename and extract relevant labels</span></span>
<span id="cb333-47"><a href="michigan-consumer-survey.html#cb333-47" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------------------------</span></span>
<span id="cb333-48"><a href="michigan-consumer-survey.html#cb333-48" tabindex="-1"></a><span class="co"># Check out the following columns, which seem to be useless</span></span>
<span id="cb333-49"><a href="michigan-consumer-survey.html#cb333-49" tabindex="-1"></a><span class="cf">if</span>(<span class="cn">FALSE</span>){</span>
<span id="cb333-50"><a href="michigan-consumer-survey.html#cb333-50" tabindex="-1"></a>    raw_labels <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(item))</span>
<span id="cb333-51"><a href="michigan-consumer-survey.html#cb333-51" tabindex="-1"></a>    raw_labels <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(range))</span>
<span id="cb333-52"><a href="michigan-consumer-survey.html#cb333-52" tabindex="-1"></a>    raw_labels <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(txt) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(labl))</span>
<span id="cb333-53"><a href="michigan-consumer-survey.html#cb333-53" tabindex="-1"></a>    raw_labels <span class="sc">%&gt;%</span> <span class="fu">filter</span>(feature <span class="sc">==</span> <span class="st">&quot;invalrng&quot;</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(labl))</span>
<span id="cb333-54"><a href="michigan-consumer-survey.html#cb333-54" tabindex="-1"></a>    raw_labels <span class="sc">%&gt;%</span> <span class="fu">pull</span>(feature) <span class="sc">%&gt;%</span> <span class="fu">unique</span>()</span>
<span id="cb333-55"><a href="michigan-consumer-survey.html#cb333-55" tabindex="-1"></a>}</span>
<span id="cb333-56"><a href="michigan-consumer-survey.html#cb333-56" tabindex="-1"></a></span>
<span id="cb333-57"><a href="michigan-consumer-survey.html#cb333-57" tabindex="-1"></a><span class="co"># Extract the relevant columns and make tidy</span></span>
<span id="cb333-58"><a href="michigan-consumer-survey.html#cb333-58" tabindex="-1"></a>var_labels <span class="ot">&lt;-</span> raw_labels <span class="sc">%&gt;%</span> </span>
<span id="cb333-59"><a href="michigan-consumer-survey.html#cb333-59" tabindex="-1"></a>    <span class="fu">select</span>(<span class="at">variable =</span> name, <span class="at">feature =</span> feature, <span class="at">value_cat =</span> catValu, </span>
<span id="cb333-60"><a href="michigan-consumer-survey.html#cb333-60" tabindex="-1"></a>           <span class="at">info =</span> labl, <span class="at">txt =</span> txt, <span class="at">dcml =</span> dcml) <span class="sc">%&gt;%</span> </span>
<span id="cb333-61"><a href="michigan-consumer-survey.html#cb333-61" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">is.na</span>(info) <span class="sc">&amp;</span> <span class="fu">is.na</span>(value_cat)) <span class="sc">&amp;</span> feature <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;labl&quot;</span>, <span class="st">&quot;qstn&quot;</span>, <span class="st">&quot;catgry&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb333-62"><a href="michigan-consumer-survey.html#cb333-62" tabindex="-1"></a>    <span class="fu">unite</span>(<span class="st">&quot;info&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;info&quot;</span>, <span class="st">&quot;txt&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb333-63"><a href="michigan-consumer-survey.html#cb333-63" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">feature =</span> <span class="fu">factor</span>(feature, <span class="at">levels =</span> <span class="fu">levels</span>(feature), </span>
<span id="cb333-64"><a href="michigan-consumer-survey.html#cb333-64" tabindex="-1"></a>                            <span class="at">labels =</span> <span class="fu">str_replace_all</span>(</span>
<span id="cb333-65"><a href="michigan-consumer-survey.html#cb333-65" tabindex="-1"></a>                                <span class="fu">levels</span>(feature), </span>
<span id="cb333-66"><a href="michigan-consumer-survey.html#cb333-66" tabindex="-1"></a>                                <span class="fu">c</span>(<span class="st">&quot;labl&quot;</span> <span class="ot">=</span> <span class="st">&quot;label_var&quot;</span>, <span class="st">&quot;qstn&quot;</span> <span class="ot">=</span> <span class="st">&quot;question&quot;</span>, <span class="st">&quot;catgry&quot;</span> <span class="ot">=</span> <span class="st">&quot;label_cat&quot;</span>)))) <span class="sc">%&gt;%</span> </span>
<span id="cb333-67"><a href="michigan-consumer-survey.html#cb333-67" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> feature, <span class="at">values_from =</span> info) <span class="sc">%&gt;%</span> </span>
<span id="cb333-68"><a href="michigan-consumer-survey.html#cb333-68" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">label_var =</span> <span class="fu">str_replace_all</span>(tools<span class="sc">::</span><span class="fu">toTitleCase</span>(<span class="fu">tolower</span>(label_var)), </span>
<span id="cb333-69"><a href="michigan-consumer-survey.html#cb333-69" tabindex="-1"></a>                                       <span class="fu">c</span>(<span class="st">&quot; Id &quot;</span> <span class="ot">=</span> <span class="st">&quot; ID &quot;</span>, <span class="st">&quot; Id$&quot;</span> <span class="ot">=</span> <span class="st">&quot; ID&quot;</span>, <span class="st">&quot;Rdd&quot;</span> <span class="ot">=</span> <span class="st">&quot;RDD&quot;</span>)))</span>
<span id="cb333-70"><a href="michigan-consumer-survey.html#cb333-70" tabindex="-1"></a></span>
<span id="cb333-71"><a href="michigan-consumer-survey.html#cb333-71" tabindex="-1"></a><span class="co"># Rename category &quot;NA&quot; = &quot;Not Applicable&quot; so that it is not confused with NA = missing</span></span>
<span id="cb333-72"><a href="michigan-consumer-survey.html#cb333-72" tabindex="-1"></a>var_labels <span class="ot">&lt;-</span> var_labels <span class="sc">%&gt;%</span> </span>
<span id="cb333-73"><a href="michigan-consumer-survey.html#cb333-73" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">label_cat =</span> <span class="fu">ifelse</span>(label_cat <span class="sc">==</span> <span class="st">&quot;NA&quot;</span>, <span class="st">&quot;Not Applicable&quot;</span>, label_cat))</span>
<span id="cb333-74"><a href="michigan-consumer-survey.html#cb333-74" tabindex="-1"></a></span>
<span id="cb333-75"><a href="michigan-consumer-survey.html#cb333-75" tabindex="-1"></a><span class="co"># Remove unnecessary rows</span></span>
<span id="cb333-76"><a href="michigan-consumer-survey.html#cb333-76" tabindex="-1"></a>var_labels <span class="ot">&lt;-</span> var_labels <span class="sc">%&gt;%</span> </span>
<span id="cb333-77"><a href="michigan-consumer-survey.html#cb333-77" tabindex="-1"></a>    <span class="fu">group_by</span>(variable) <span class="sc">%&gt;%</span> </span>
<span id="cb333-78"><a href="michigan-consumer-survey.html#cb333-78" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(<span class="st">&quot;label_var&quot;</span>, <span class="st">&quot;question&quot;</span>), </span>
<span id="cb333-79"><a href="michigan-consumer-survey.html#cb333-79" tabindex="-1"></a>                  <span class="cf">function</span>(x) <span class="fu">ifelse</span>(<span class="fu">is.na</span>(x), <span class="fu">first</span>(x[<span class="sc">!</span><span class="fu">is.na</span>(x)]), x))) <span class="sc">%&gt;%</span> </span>
<span id="cb333-80"><a href="michigan-consumer-survey.html#cb333-80" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span>(<span class="fu">n</span>() <span class="sc">&gt;</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="fu">is.na</span>(label_cat))) <span class="sc">%&gt;%</span> </span>
<span id="cb333-81"><a href="michigan-consumer-survey.html#cb333-81" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb333-82"><a href="michigan-consumer-survey.html#cb333-82" tabindex="-1"></a>    <span class="fu">relocate</span>(variable, label_var, dcml, value_cat, label_cat, question)</span>
<span id="cb333-83"><a href="michigan-consumer-survey.html#cb333-83" tabindex="-1"></a></span>
<span id="cb333-84"><a href="michigan-consumer-survey.html#cb333-84" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------------------------</span></span>
<span id="cb333-85"><a href="michigan-consumer-survey.html#cb333-85" tabindex="-1"></a><span class="co"># Create new variables and missing labels</span></span>
<span id="cb333-86"><a href="michigan-consumer-survey.html#cb333-86" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------------------------</span></span>
<span id="cb333-87"><a href="michigan-consumer-survey.html#cb333-87" tabindex="-1"></a><span class="co"># Labels for new variables defined later</span></span>
<span id="cb333-88"><a href="michigan-consumer-survey.html#cb333-88" tabindex="-1"></a>new_variables <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb333-89"><a href="michigan-consumer-survey.html#cb333-89" tabindex="-1"></a>    <span class="sc">~</span>variable, <span class="sc">~</span>label_var, <span class="sc">~</span>dcml, <span class="sc">~</span>question,</span>
<span id="cb333-90"><a href="michigan-consumer-survey.html#cb333-90" tabindex="-1"></a>    <span class="st">&quot;DATE&quot;</span>, <span class="st">&quot;Date&quot;</span>, <span class="cn">NA</span>, <span class="st">&quot;Date&quot;</span>,</span>
<span id="cb333-91"><a href="michigan-consumer-survey.html#cb333-91" tabindex="-1"></a>    <span class="st">&quot;R&quot;</span>, <span class="st">&quot;Respondent ID&quot;</span>, 0L, </span>
<span id="cb333-92"><a href="michigan-consumer-survey.html#cb333-92" tabindex="-1"></a>    <span class="fu">paste</span>(<span class="st">&quot;Respondent ID that remains fixed over time&quot;</span>,</span>
<span id="cb333-93"><a href="michigan-consumer-survey.html#cb333-93" tabindex="-1"></a>          <span class="st">&quot;if the respondent participates multiple times.&quot;</span>)</span>
<span id="cb333-94"><a href="michigan-consumer-survey.html#cb333-94" tabindex="-1"></a>)</span>
<span id="cb333-95"><a href="michigan-consumer-survey.html#cb333-95" tabindex="-1"></a></span>
<span id="cb333-96"><a href="michigan-consumer-survey.html#cb333-96" tabindex="-1"></a><span class="co"># Add new labels to existing labels</span></span>
<span id="cb333-97"><a href="michigan-consumer-survey.html#cb333-97" tabindex="-1"></a>var_labels <span class="ot">&lt;-</span> new_variables <span class="sc">%&gt;%</span> </span>
<span id="cb333-98"><a href="michigan-consumer-survey.html#cb333-98" tabindex="-1"></a>    <span class="fu">bind_rows</span>(var_labels)</span>
<span id="cb333-99"><a href="michigan-consumer-survey.html#cb333-99" tabindex="-1"></a></span>
<span id="cb333-100"><a href="michigan-consumer-survey.html#cb333-100" tabindex="-1"></a><span class="co"># Labels for categories that were not properly defined</span></span>
<span id="cb333-101"><a href="michigan-consumer-survey.html#cb333-101" tabindex="-1"></a>new_categories <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb333-102"><a href="michigan-consumer-survey.html#cb333-102" tabindex="-1"></a>    <span class="sc">~</span>variable, <span class="sc">~</span>value_cat, <span class="sc">~</span>label_cat,</span>
<span id="cb333-103"><a href="michigan-consumer-survey.html#cb333-103" tabindex="-1"></a>    <span class="st">&quot;HOMEAMT&quot;</span>, 9999998L, <span class="st">&quot;DK&quot;</span>,</span>
<span id="cb333-104"><a href="michigan-consumer-survey.html#cb333-104" tabindex="-1"></a>    <span class="st">&quot;INVAMT&quot;</span>, 99999998L, <span class="st">&quot;DK&quot;</span></span>
<span id="cb333-105"><a href="michigan-consumer-survey.html#cb333-105" tabindex="-1"></a>)</span>
<span id="cb333-106"><a href="michigan-consumer-survey.html#cb333-106" tabindex="-1"></a>new_categories <span class="ot">&lt;-</span> var_labels <span class="sc">%&gt;%</span> </span>
<span id="cb333-107"><a href="michigan-consumer-survey.html#cb333-107" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>label_cat, <span class="sc">-</span>value_cat) <span class="sc">%&gt;%</span> </span>
<span id="cb333-108"><a href="michigan-consumer-survey.html#cb333-108" tabindex="-1"></a>    <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb333-109"><a href="michigan-consumer-survey.html#cb333-109" tabindex="-1"></a>    <span class="fu">right_join</span>(new_categories, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;variable&quot;</span>))</span>
<span id="cb333-110"><a href="michigan-consumer-survey.html#cb333-110" tabindex="-1"></a></span>
<span id="cb333-111"><a href="michigan-consumer-survey.html#cb333-111" tabindex="-1"></a><span class="co"># Add new labels to existing labels</span></span>
<span id="cb333-112"><a href="michigan-consumer-survey.html#cb333-112" tabindex="-1"></a>var_labels <span class="ot">&lt;-</span> var_labels <span class="sc">%&gt;%</span> </span>
<span id="cb333-113"><a href="michigan-consumer-survey.html#cb333-113" tabindex="-1"></a>    <span class="fu">bind_rows</span>(new_categories) <span class="sc">%&gt;%</span> </span>
<span id="cb333-114"><a href="michigan-consumer-survey.html#cb333-114" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">factor</span>(variable, </span>
<span id="cb333-115"><a href="michigan-consumer-survey.html#cb333-115" tabindex="-1"></a>                             <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&quot;CASEID&quot;</span>, <span class="fu">setdiff</span>(<span class="fu">unique</span>(variable), <span class="st">&quot;CASEID&quot;</span>)), </span>
<span id="cb333-116"><a href="michigan-consumer-survey.html#cb333-116" tabindex="-1"></a>                             <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb333-117"><a href="michigan-consumer-survey.html#cb333-117" tabindex="-1"></a>    <span class="fu">arrange</span>(variable, value_cat)</span>
<span id="cb333-118"><a href="michigan-consumer-survey.html#cb333-118" tabindex="-1"></a></span>
<span id="cb333-119"><a href="michigan-consumer-survey.html#cb333-119" tabindex="-1"></a><span class="co"># Print labels</span></span>
<span id="cb333-120"><a href="michigan-consumer-survey.html#cb333-120" tabindex="-1"></a>var_labels</span></code></pre></div>
<pre><code>## # A tibble: 1,022 × 6
##    variable label_var           dcml question value_cat label_cat
##    &lt;ord&gt;    &lt;chr&gt;              &lt;int&gt; &lt;chr&gt;        &lt;int&gt; &lt;chr&gt;    
##  1 CASEID   Case Identificati…     0 &lt;NA&gt;            NA &lt;NA&gt;     
##  2 DATE     Date                  NA Date            NA &lt;NA&gt;     
##  3 R        Respondent ID          0 Respond…        NA &lt;NA&gt;     
##  4 YYYYMM   Survey Year &amp; Mon…     0 Survey …        NA &lt;NA&gt;     
##  5 YYYYQ    Survey Year &amp; Qua…     0 Survey …        NA &lt;NA&gt;     
##  6 YYYY     Survey Year            0 Survey …        NA &lt;NA&gt;     
##  7 ID       Interview ID           0 Intervi…        NA &lt;NA&gt;     
##  8 IDPREV   Previous ID in RDD     0 Previou…        NA &lt;NA&gt;     
##  9 DATEPR   Date of Previous …     0 Previou…        NA &lt;NA&gt;     
## 10 ICS      Index of Consumer…     2 The Ind…        NA &lt;NA&gt;     
## # ℹ 1,012 more rows</code></pre>
</div>
<div id="importing-the-data-set" class="section level3 hasAnchor" number="20.5.3">
<h3><span class="header-section-number">20.5.3</span> Importing the Data Set<a href="michigan-consumer-survey.html#importing-the-data-set" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The data is imported as a CSV file and cleaned. The data includes creating new date variables and respondent ID that remains constant across multiple survey participation.</p>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="michigan-consumer-survey.html#cb335-1" tabindex="-1"></a><span class="co">#================================================================================================</span></span>
<span id="cb335-2"><a href="michigan-consumer-survey.html#cb335-2" tabindex="-1"></a><span class="co"># Data Set</span></span>
<span id="cb335-3"><a href="michigan-consumer-survey.html#cb335-3" tabindex="-1"></a><span class="co">#================================================================================================</span></span>
<span id="cb335-4"><a href="michigan-consumer-survey.html#cb335-4" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------------------------</span></span>
<span id="cb335-5"><a href="michigan-consumer-survey.html#cb335-5" tabindex="-1"></a><span class="co"># Import data set</span></span>
<span id="cb335-6"><a href="michigan-consumer-survey.html#cb335-6" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------------------------</span></span>
<span id="cb335-7"><a href="michigan-consumer-survey.html#cb335-7" tabindex="-1"></a>CS_raw <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(data_file)</span>
<span id="cb335-8"><a href="michigan-consumer-survey.html#cb335-8" tabindex="-1"></a>CS_tidy <span class="ot">&lt;-</span> CS_raw</span>
<span id="cb335-9"><a href="michigan-consumer-survey.html#cb335-9" tabindex="-1"></a></span>
<span id="cb335-10"><a href="michigan-consumer-survey.html#cb335-10" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------------------------</span></span>
<span id="cb335-11"><a href="michigan-consumer-survey.html#cb335-11" tabindex="-1"></a><span class="co"># Create date variables</span></span>
<span id="cb335-12"><a href="michigan-consumer-survey.html#cb335-12" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------------------------</span></span>
<span id="cb335-13"><a href="michigan-consumer-survey.html#cb335-13" tabindex="-1"></a>CS_tidy <span class="ot">&lt;-</span> CS_tidy <span class="sc">%&gt;%</span> </span>
<span id="cb335-14"><a href="michigan-consumer-survey.html#cb335-14" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">DATE =</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(CS_tidy<span class="sc">$</span>YYYYMM, <span class="st">&quot;01&quot;</span>), <span class="at">format =</span> <span class="st">&quot;%Y%m%d&quot;</span>),</span>
<span id="cb335-15"><a href="michigan-consumer-survey.html#cb335-15" tabindex="-1"></a>           <span class="at">DATEPREV =</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(CS_tidy<span class="sc">$</span>DATEPR, <span class="st">&quot;01&quot;</span>), <span class="at">format =</span> <span class="st">&quot;%Y%m%d&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb335-16"><a href="michigan-consumer-survey.html#cb335-16" tabindex="-1"></a>    <span class="fu">relocate</span>(CASEID, DATE, DATEPREV)</span>
<span id="cb335-17"><a href="michigan-consumer-survey.html#cb335-17" tabindex="-1"></a></span>
<span id="cb335-18"><a href="michigan-consumer-survey.html#cb335-18" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------------------------</span></span>
<span id="cb335-19"><a href="michigan-consumer-survey.html#cb335-19" tabindex="-1"></a><span class="co"># Respondents can participate multiple times -&gt; Generate respondent ID that remains fixed</span></span>
<span id="cb335-20"><a href="michigan-consumer-survey.html#cb335-20" tabindex="-1"></a><span class="co">#------------------------------------------------------------------------------------------------</span></span>
<span id="cb335-21"><a href="michigan-consumer-survey.html#cb335-21" tabindex="-1"></a><span class="co"># ID and IDPREV count individuals from scratch every period, whereas CASEID is unique</span></span>
<span id="cb335-22"><a href="michigan-consumer-survey.html#cb335-22" tabindex="-1"></a><span class="cf">if</span>(<span class="cn">FALSE</span>){</span>
<span id="cb335-23"><a href="michigan-consumer-survey.html#cb335-23" tabindex="-1"></a>    CS_tidy <span class="sc">%&gt;%</span> <span class="fu">select</span>(CASEID) <span class="sc">%&gt;%</span> <span class="fu">duplicated</span>() <span class="sc">%&gt;%</span> <span class="fu">sum</span>()</span>
<span id="cb335-24"><a href="michigan-consumer-survey.html#cb335-24" tabindex="-1"></a>    CS_tidy <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID) <span class="sc">%&gt;%</span> <span class="fu">duplicated</span>() <span class="sc">%&gt;%</span> <span class="fu">sum</span>()</span>
<span id="cb335-25"><a href="michigan-consumer-survey.html#cb335-25" tabindex="-1"></a>    CS_tidy <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, DATE) <span class="sc">%&gt;%</span> <span class="fu">duplicated</span>() <span class="sc">%&gt;%</span> <span class="fu">sum</span>()</span>
<span id="cb335-26"><a href="michigan-consumer-survey.html#cb335-26" tabindex="-1"></a>}</span>
<span id="cb335-27"><a href="michigan-consumer-survey.html#cb335-27" tabindex="-1"></a></span>
<span id="cb335-28"><a href="michigan-consumer-survey.html#cb335-28" tabindex="-1"></a><span class="co"># Data matches ID/DATE with IDPREV/DATEPREV, but doesn&#39;t go further back - find oldest ID/DATE pair</span></span>
<span id="cb335-29"><a href="michigan-consumer-survey.html#cb335-29" tabindex="-1"></a>r_matches <span class="ot">&lt;-</span> CS_tidy <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(IDPREV) <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(DATEPREV)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(ID, DATE, IDPREV, DATEPREV)</span>
<span id="cb335-30"><a href="michigan-consumer-survey.html#cb335-30" tabindex="-1"></a><span class="cf">while</span>(<span class="fu">nrow</span>(<span class="fu">semi_join</span>(r_matches, r_matches, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;IDPREV&quot;</span> <span class="ot">=</span> <span class="st">&quot;ID&quot;</span>, <span class="st">&quot;DATEPREV&quot;</span> <span class="ot">=</span> <span class="st">&quot;DATE&quot;</span>))) <span class="sc">&gt;</span> <span class="dv">0</span>){</span>
<span id="cb335-31"><a href="michigan-consumer-survey.html#cb335-31" tabindex="-1"></a>r_matches <span class="ot">&lt;-</span> r_matches <span class="sc">%&gt;%</span> </span>
<span id="cb335-32"><a href="michigan-consumer-survey.html#cb335-32" tabindex="-1"></a>    <span class="fu">left_join</span>(r_matches, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;IDPREV&quot;</span> <span class="ot">=</span> <span class="st">&quot;ID&quot;</span>, <span class="st">&quot;DATEPREV&quot;</span> <span class="ot">=</span> <span class="st">&quot;DATE&quot;</span>), <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;2&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb335-33"><a href="michigan-consumer-survey.html#cb335-33" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">IDPREV =</span> <span class="fu">if_else</span>(<span class="sc">!</span><span class="fu">is.na</span>(IDPREV2), IDPREV2, IDPREV),</span>
<span id="cb335-34"><a href="michigan-consumer-survey.html#cb335-34" tabindex="-1"></a>           <span class="at">DATEPREV =</span> <span class="fu">if_else</span>(<span class="sc">!</span><span class="fu">is.na</span>(DATEPREV2), DATEPREV2, DATEPREV)) <span class="sc">%&gt;%</span> </span>
<span id="cb335-35"><a href="michigan-consumer-survey.html#cb335-35" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>IDPREV2, <span class="sc">-</span>DATEPREV2)</span>
<span id="cb335-36"><a href="michigan-consumer-survey.html#cb335-36" tabindex="-1"></a>}</span>
<span id="cb335-37"><a href="michigan-consumer-survey.html#cb335-37" tabindex="-1"></a></span>
<span id="cb335-38"><a href="michigan-consumer-survey.html#cb335-38" tabindex="-1"></a><span class="co"># Create &quot;R&quot; (Respondent) variable that remains fixed over time</span></span>
<span id="cb335-39"><a href="michigan-consumer-survey.html#cb335-39" tabindex="-1"></a>r_matches <span class="ot">&lt;-</span> r_matches <span class="sc">%&gt;%</span> </span>
<span id="cb335-40"><a href="michigan-consumer-survey.html#cb335-40" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">R =</span> <span class="fu">paste</span>(IDPREV, DATEPREV, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>))</span>
<span id="cb335-41"><a href="michigan-consumer-survey.html#cb335-41" tabindex="-1"></a></span>
<span id="cb335-42"><a href="michigan-consumer-survey.html#cb335-42" tabindex="-1"></a><span class="co"># Include &quot;R&quot; in the data set</span></span>
<span id="cb335-43"><a href="michigan-consumer-survey.html#cb335-43" tabindex="-1"></a>CS_tidy <span class="ot">&lt;-</span> CS_tidy <span class="sc">%&gt;%</span> </span>
<span id="cb335-44"><a href="michigan-consumer-survey.html#cb335-44" tabindex="-1"></a>    <span class="fu">left_join</span>(<span class="fu">select</span>(r_matches, <span class="fu">c</span>(<span class="st">&quot;R&quot;</span>, <span class="st">&quot;ID&quot;</span>, <span class="st">&quot;DATE&quot;</span>)), <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;ID&quot;</span>, <span class="st">&quot;DATE&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb335-45"><a href="michigan-consumer-survey.html#cb335-45" tabindex="-1"></a>    <span class="fu">relocate</span>(DATE, R) <span class="sc">%&gt;%</span> </span>
<span id="cb335-46"><a href="michigan-consumer-survey.html#cb335-46" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">R =</span> <span class="fu">ifelse</span>(<span class="at">test =</span> <span class="fu">is.na</span>(IDPREV), </span>
<span id="cb335-47"><a href="michigan-consumer-survey.html#cb335-47" tabindex="-1"></a>                      <span class="at">yes =</span> <span class="fu">paste</span>(ID, DATE, <span class="at">sep =</span> <span class="st">&quot;_&quot;</span>),</span>
<span id="cb335-48"><a href="michigan-consumer-survey.html#cb335-48" tabindex="-1"></a>                      <span class="at">no =</span> R)) <span class="sc">%&gt;%</span> </span>
<span id="cb335-49"><a href="michigan-consumer-survey.html#cb335-49" tabindex="-1"></a>    <span class="co"># Use numbers for &quot;R&quot; from 1 to length(unique(CS_tidy$R)) instead of R = ID_DATE</span></span>
<span id="cb335-50"><a href="michigan-consumer-survey.html#cb335-50" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">R =</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(R, <span class="at">levels =</span> <span class="fu">unique</span>(R)))) <span class="sc">%&gt;%</span> </span>
<span id="cb335-51"><a href="michigan-consumer-survey.html#cb335-51" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>DATEPREV)</span>
<span id="cb335-52"><a href="michigan-consumer-survey.html#cb335-52" tabindex="-1"></a></span>
<span id="cb335-53"><a href="michigan-consumer-survey.html#cb335-53" tabindex="-1"></a><span class="co"># Check how many times the same respondent participated in the survey</span></span>
<span id="cb335-54"><a href="michigan-consumer-survey.html#cb335-54" tabindex="-1"></a><span class="cf">if</span>(<span class="cn">FALSE</span>){</span>
<span id="cb335-55"><a href="michigan-consumer-survey.html#cb335-55" tabindex="-1"></a>    CS_tidy <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">is.na</span>(R))</span>
<span id="cb335-56"><a href="michigan-consumer-survey.html#cb335-56" tabindex="-1"></a>    CS_tidy <span class="sc">%&gt;%</span> <span class="fu">count</span>(R) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(n) <span class="sc">%&gt;%</span> </span>
<span id="cb335-57"><a href="michigan-consumer-survey.html#cb335-57" tabindex="-1"></a>        <span class="fu">summarize</span>(<span class="at">freq =</span> <span class="fu">n</span>(), <span class="at">sum =</span> <span class="fu">sum</span>(n))</span>
<span id="cb335-58"><a href="michigan-consumer-survey.html#cb335-58" tabindex="-1"></a>}</span>
<span id="cb335-59"><a href="michigan-consumer-survey.html#cb335-59" tabindex="-1"></a></span>
<span id="cb335-60"><a href="michigan-consumer-survey.html#cb335-60" tabindex="-1"></a><span class="co"># Add variable labels</span></span>
<span id="cb335-61"><a href="michigan-consumer-survey.html#cb335-61" tabindex="-1"></a><span class="fu">attr</span>(CS_tidy, <span class="st">&quot;labels&quot;</span>) <span class="ot">&lt;-</span> var_labels</span>
<span id="cb335-62"><a href="michigan-consumer-survey.html#cb335-62" tabindex="-1"></a></span>
<span id="cb335-63"><a href="michigan-consumer-survey.html#cb335-63" tabindex="-1"></a><span class="co"># Print data</span></span>
<span id="cb335-64"><a href="michigan-consumer-survey.html#cb335-64" tabindex="-1"></a>CS_tidy</span></code></pre></div>
<pre><code>## # A tibble: 312,130 × 113
##    DATE           R CASEID YYYYMM YYYYQ  YYYY    ID IDPREV DATEPR
##    &lt;date&gt;     &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
##  1 1978-01-01     1      1 197801 19781  1978     1     NA     NA
##  2 1978-01-01     2      2 197801 19781  1978     2     NA     NA
##  3 1978-01-01     3      3 197801 19781  1978     3     NA     NA
##  4 1978-01-01     4      4 197801 19781  1978     4     NA     NA
##  5 1978-01-01     5      5 197801 19781  1978     5     NA     NA
##  6 1978-01-01     6      6 197801 19781  1978     6     NA     NA
##  7 1978-01-01     7      7 197801 19781  1978     7     NA     NA
##  8 1978-01-01     8      8 197801 19781  1978     8     NA     NA
##  9 1978-01-01     9      9 197801 19781  1978     9     NA     NA
## 10 1978-01-01    10     10 197801 19781  1978    10     NA     NA
## # ℹ 312,120 more rows
## # ℹ 104 more variables: ICS &lt;dbl&gt;, ICC &lt;dbl&gt;, ICE &lt;dbl&gt;,
## #   PAGO &lt;dbl&gt;, PAGOR1 &lt;dbl&gt;, PAGOR2 &lt;dbl&gt;, PAGO5 &lt;dbl&gt;,
## #   PEXP &lt;dbl&gt;, PEXP5 &lt;dbl&gt;, INEXQ1 &lt;dbl&gt;, INEXQ2 &lt;dbl&gt;,
## #   INEX &lt;dbl&gt;, RINC &lt;dbl&gt;, BAGO &lt;dbl&gt;, BEXP &lt;dbl&gt;, BUS12 &lt;dbl&gt;,
## #   BUS5 &lt;dbl&gt;, NEWS1 &lt;dbl&gt;, NEWS2 &lt;dbl&gt;, UNEMP &lt;dbl&gt;,
## #   GOVT &lt;dbl&gt;, RATEX &lt;dbl&gt;, PX1Q1 &lt;dbl&gt;, PX1Q2 &lt;dbl&gt;, …</code></pre>
</div>
<div id="long-format" class="section level3 hasAnchor" number="20.5.4">
<h3><span class="header-section-number">20.5.4</span> Long Format<a href="michigan-consumer-survey.html#long-format" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Convert the data from wide to long format. This changes the layout of the data such that each row is an observation, and each column is a variable.</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="michigan-consumer-survey.html#cb337-1" tabindex="-1"></a><span class="co">#================================================================================================</span></span>
<span id="cb337-2"><a href="michigan-consumer-survey.html#cb337-2" tabindex="-1"></a><span class="co"># Long Format</span></span>
<span id="cb337-3"><a href="michigan-consumer-survey.html#cb337-3" tabindex="-1"></a><span class="co">#================================================================================================</span></span>
<span id="cb337-4"><a href="michigan-consumer-survey.html#cb337-4" tabindex="-1"></a><span class="co"># Convert wide (= tidy, each column is a variable) to long format</span></span>
<span id="cb337-5"><a href="michigan-consumer-survey.html#cb337-5" tabindex="-1"></a>CS <span class="ot">&lt;-</span> CS_tidy <span class="sc">%&gt;%</span> </span>
<span id="cb337-6"><a href="michigan-consumer-survey.html#cb337-6" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="st">&quot;CASEID&quot;</span>, <span class="st">&quot;R&quot;</span>, <span class="st">&quot;DATE&quot;</span>, <span class="st">&quot;WT&quot;</span>), </span>
<span id="cb337-7"><a href="michigan-consumer-survey.html#cb337-7" tabindex="-1"></a>                 <span class="at">names_to =</span> <span class="st">&quot;variable&quot;</span>,</span>
<span id="cb337-8"><a href="michigan-consumer-survey.html#cb337-8" tabindex="-1"></a>                 <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>,</span>
<span id="cb337-9"><a href="michigan-consumer-survey.html#cb337-9" tabindex="-1"></a>                 <span class="at">values_transform =</span> as.numeric,</span>
<span id="cb337-10"><a href="michigan-consumer-survey.html#cb337-10" tabindex="-1"></a>                 <span class="at">values_drop_na =</span> <span class="cn">TRUE</span>)</span>
<span id="cb337-11"><a href="michigan-consumer-survey.html#cb337-11" tabindex="-1"></a></span>
<span id="cb337-12"><a href="michigan-consumer-survey.html#cb337-12" tabindex="-1"></a><span class="co"># Keep label attributes</span></span>
<span id="cb337-13"><a href="michigan-consumer-survey.html#cb337-13" tabindex="-1"></a><span class="fu">attr</span>(CS, <span class="st">&quot;labels&quot;</span>) <span class="ot">&lt;-</span> <span class="fu">attr</span>(CS_tidy, <span class="st">&quot;labels&quot;</span>)</span>
<span id="cb337-14"><a href="michigan-consumer-survey.html#cb337-14" tabindex="-1"></a></span>
<span id="cb337-15"><a href="michigan-consumer-survey.html#cb337-15" tabindex="-1"></a><span class="co"># Add variable labels</span></span>
<span id="cb337-16"><a href="michigan-consumer-survey.html#cb337-16" tabindex="-1"></a>CS <span class="ot">&lt;-</span> CS <span class="sc">%&gt;%</span> </span>
<span id="cb337-17"><a href="michigan-consumer-survey.html#cb337-17" tabindex="-1"></a>    <span class="fu">left_join</span>(</span>
<span id="cb337-18"><a href="michigan-consumer-survey.html#cb337-18" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">attr</span>(CS, <span class="st">&quot;labels&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb337-19"><a href="michigan-consumer-survey.html#cb337-19" tabindex="-1"></a>            <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">&quot;variable&quot;</span>, <span class="st">&quot;label_var&quot;</span>, <span class="st">&quot;dcml&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb337-20"><a href="michigan-consumer-survey.html#cb337-20" tabindex="-1"></a>            <span class="fu">distinct</span>(),</span>
<span id="cb337-21"><a href="michigan-consumer-survey.html#cb337-21" tabindex="-1"></a>        <span class="at">by =</span> <span class="st">&quot;variable&quot;</span></span>
<span id="cb337-22"><a href="michigan-consumer-survey.html#cb337-22" tabindex="-1"></a>    )</span>
<span id="cb337-23"><a href="michigan-consumer-survey.html#cb337-23" tabindex="-1"></a></span>
<span id="cb337-24"><a href="michigan-consumer-survey.html#cb337-24" tabindex="-1"></a><span class="co"># Add factor labels</span></span>
<span id="cb337-25"><a href="michigan-consumer-survey.html#cb337-25" tabindex="-1"></a>CS <span class="ot">&lt;-</span> CS <span class="sc">%&gt;%</span> </span>
<span id="cb337-26"><a href="michigan-consumer-survey.html#cb337-26" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value_cat =</span> <span class="fu">ifelse</span>(dcml <span class="sc">==</span> <span class="dv">0</span>, <span class="fu">as.integer</span>(value), <span class="cn">NA_integer_</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb337-27"><a href="michigan-consumer-survey.html#cb337-27" tabindex="-1"></a>    <span class="fu">left_join</span>(</span>
<span id="cb337-28"><a href="michigan-consumer-survey.html#cb337-28" tabindex="-1"></a>        <span class="at">y =</span> <span class="fu">attr</span>(CS, <span class="st">&quot;labels&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb337-29"><a href="michigan-consumer-survey.html#cb337-29" tabindex="-1"></a>            <span class="fu">select</span>(<span class="fu">c</span>(<span class="st">&quot;variable&quot;</span>, <span class="st">&quot;label_cat&quot;</span>, <span class="st">&quot;value_cat&quot;</span>)),</span>
<span id="cb337-30"><a href="michigan-consumer-survey.html#cb337-30" tabindex="-1"></a>        <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;variable&quot;</span>, <span class="st">&quot;value_cat&quot;</span>)</span>
<span id="cb337-31"><a href="michigan-consumer-survey.html#cb337-31" tabindex="-1"></a>    )</span>
<span id="cb337-32"><a href="michigan-consumer-survey.html#cb337-32" tabindex="-1"></a></span>
<span id="cb337-33"><a href="michigan-consumer-survey.html#cb337-33" tabindex="-1"></a><span class="co"># Separate between categorical values and numerical values</span></span>
<span id="cb337-34"><a href="michigan-consumer-survey.html#cb337-34" tabindex="-1"></a>CS <span class="ot">&lt;-</span> CS <span class="sc">%&gt;%</span> </span>
<span id="cb337-35"><a href="michigan-consumer-survey.html#cb337-35" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">value_cat =</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(label_cat), value_cat, <span class="cn">NA_integer_</span>),</span>
<span id="cb337-36"><a href="michigan-consumer-survey.html#cb337-36" tabindex="-1"></a>           <span class="at">value =</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(value_cat), <span class="cn">NA_real_</span>, value))</span>
<span id="cb337-37"><a href="michigan-consumer-survey.html#cb337-37" tabindex="-1"></a></span>
<span id="cb337-38"><a href="michigan-consumer-survey.html#cb337-38" tabindex="-1"></a><span class="co"># Organize data</span></span>
<span id="cb337-39"><a href="michigan-consumer-survey.html#cb337-39" tabindex="-1"></a>CS <span class="ot">&lt;-</span> CS <span class="sc">%&gt;%</span> </span>
<span id="cb337-40"><a href="michigan-consumer-survey.html#cb337-40" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">factor</span>(variable, <span class="at">levels =</span> <span class="fu">unique</span>(variable), <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb337-41"><a href="michigan-consumer-survey.html#cb337-41" tabindex="-1"></a>    <span class="fu">arrange</span>(DATE, R, variable, value_cat) <span class="sc">%&gt;%</span> </span>
<span id="cb337-42"><a href="michigan-consumer-survey.html#cb337-42" tabindex="-1"></a>    <span class="fu">relocate</span>(CASEID, DATE, R, WT, variable, dcml, value, value_cat, label_cat, label_var)</span>
<span id="cb337-43"><a href="michigan-consumer-survey.html#cb337-43" tabindex="-1"></a></span>
<span id="cb337-44"><a href="michigan-consumer-survey.html#cb337-44" tabindex="-1"></a><span class="co"># Check if there is only one answer per CASEID, person, time period, and question:</span></span>
<span id="cb337-45"><a href="michigan-consumer-survey.html#cb337-45" tabindex="-1"></a><span class="cf">if</span>(<span class="cn">FALSE</span>){</span>
<span id="cb337-46"><a href="michigan-consumer-survey.html#cb337-46" tabindex="-1"></a>    CS <span class="sc">%&gt;%</span> <span class="fu">count</span>()</span>
<span id="cb337-47"><a href="michigan-consumer-survey.html#cb337-47" tabindex="-1"></a>    CS <span class="sc">%&gt;%</span> <span class="fu">distinct</span>(CASEID, variable) <span class="sc">%&gt;%</span> <span class="fu">count</span>()</span>
<span id="cb337-48"><a href="michigan-consumer-survey.html#cb337-48" tabindex="-1"></a>}</span>
<span id="cb337-49"><a href="michigan-consumer-survey.html#cb337-49" tabindex="-1"></a></span>
<span id="cb337-50"><a href="michigan-consumer-survey.html#cb337-50" tabindex="-1"></a><span class="co"># Print data</span></span>
<span id="cb337-51"><a href="michigan-consumer-survey.html#cb337-51" tabindex="-1"></a>CS</span></code></pre></div>
<pre><code>## # A tibble: 23,732,842 × 10
##    CASEID DATE           R    WT variable  dcml   value value_cat
##     &lt;dbl&gt; &lt;date&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;ord&gt;    &lt;int&gt;   &lt;dbl&gt;     &lt;int&gt;
##  1      1 1978-01-01     1     0 YYYYMM       0  1.98e5        NA
##  2      1 1978-01-01     1     0 YYYYQ        0  1.98e4        NA
##  3      1 1978-01-01     1     0 YYYY         0  1.98e3        NA
##  4      1 1978-01-01     1     0 ID           0  1   e0        NA
##  5      1 1978-01-01     1     0 ICS          2  7.67e1        NA
##  6      1 1978-01-01     1     0 ICC          2  1.16e2        NA
##  7      1 1978-01-01     1     0 ICE          2  5.13e1        NA
##  8      1 1978-01-01     1     0 PAGO         0 NA              3
##  9      1 1978-01-01     1     0 PAGOR1       0 NA             99
## 10      1 1978-01-01     1     0 PAGOR2       0 NA              0
## # ℹ 23,732,832 more rows
## # ℹ 2 more variables: label_cat &lt;chr&gt;, label_var &lt;chr&gt;</code></pre>
</div>
<div id="saving-the-data" class="section level3 hasAnchor" number="20.5.5">
<h3><span class="header-section-number">20.5.5</span> Saving the Data<a href="michigan-consumer-survey.html#saving-the-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The cleaned data is saved as both CSV and RDS files under the <code>downloads</code> folder.</p>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="michigan-consumer-survey.html#cb339-1" tabindex="-1"></a><span class="co"># Create downloads folder</span></span>
<span id="cb339-2"><a href="michigan-consumer-survey.html#cb339-2" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="st">&quot;downloads&quot;</span>)</span>
<span id="cb339-3"><a href="michigan-consumer-survey.html#cb339-3" tabindex="-1"></a></span>
<span id="cb339-4"><a href="michigan-consumer-survey.html#cb339-4" tabindex="-1"></a><span class="co"># Save data as RDS files</span></span>
<span id="cb339-5"><a href="michigan-consumer-survey.html#cb339-5" tabindex="-1"></a><span class="fu">saveRDS</span>(CS_tidy, <span class="fu">file.path</span>(<span class="st">&quot;downloads&quot;</span>, <span class="st">&quot;CS_tidy.rds&quot;</span>))</span>
<span id="cb339-6"><a href="michigan-consumer-survey.html#cb339-6" tabindex="-1"></a><span class="fu">saveRDS</span>(CS, <span class="fu">file.path</span>(<span class="st">&quot;downloads&quot;</span>, <span class="st">&quot;CS.rds&quot;</span>))</span>
<span id="cb339-7"><a href="michigan-consumer-survey.html#cb339-7" tabindex="-1"></a></span>
<span id="cb339-8"><a href="michigan-consumer-survey.html#cb339-8" tabindex="-1"></a><span class="co"># Save data as CSV files</span></span>
<span id="cb339-9"><a href="michigan-consumer-survey.html#cb339-9" tabindex="-1"></a><span class="fu">write_csv</span>(CS_tidy, <span class="fu">file.path</span>(<span class="st">&quot;downloads&quot;</span>, <span class="st">&quot;CS_tidy.csv&quot;</span>))</span>
<span id="cb339-10"><a href="michigan-consumer-survey.html#cb339-10" tabindex="-1"></a><span class="fu">write_csv</span>(CS, <span class="fu">file.path</span>(<span class="st">&quot;downloads&quot;</span>, <span class="st">&quot;CS.csv&quot;</span>))</span>
<span id="cb339-11"><a href="michigan-consumer-survey.html#cb339-11" tabindex="-1"></a><span class="fu">write_csv</span>(<span class="fu">attr</span>(CS, <span class="st">&quot;labels&quot;</span>), <span class="fu">file.path</span>(<span class="st">&quot;downloads&quot;</span>, <span class="st">&quot;CS_labels.csv&quot;</span>))</span>
<span id="cb339-12"><a href="michigan-consumer-survey.html#cb339-12" tabindex="-1"></a></span>
<span id="cb339-13"><a href="michigan-consumer-survey.html#cb339-13" tabindex="-1"></a><span class="co"># Save raw data</span></span>
<span id="cb339-14"><a href="michigan-consumer-survey.html#cb339-14" tabindex="-1"></a><span class="fu">write_csv</span>(CS_raw, <span class="fu">file.path</span>(<span class="st">&quot;downloads&quot;</span>, <span class="st">&quot;CS_raw_data.csv&quot;</span>))</span>
<span id="cb339-15"><a href="michigan-consumer-survey.html#cb339-15" tabindex="-1"></a><span class="fu">writeLines</span>(<span class="fu">readLines</span>(data_label_file), <span class="fu">file.path</span>(<span class="st">&quot;downloads&quot;</span>, <span class="st">&quot;CS_raw_labels.txt&quot;</span>))</span></code></pre></div>
<p>That wraps up the process of importing and cleaning the Michigan Consumer Survey data. You can now proceed to analyze the data. To load the data in a future session, you can use the <code>readRDS()</code> function.</p>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="michigan-consumer-survey.html#cb340-1" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb340-2"><a href="michigan-consumer-survey.html#cb340-2" tabindex="-1"></a><span class="co"># data &lt;- readRDS(&quot;downloads/CS.rds&quot;)</span></span></code></pre></div>
</div>
</div>
<div id="exploring-individual-level-data" class="section level2 hasAnchor" number="20.6">
<h2><span class="header-section-number">20.6</span> Exploring Individual-Level Data<a href="michigan-consumer-survey.html#exploring-individual-level-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s visualize some of the individual-level data:</p>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="michigan-consumer-survey.html#cb341-1" tabindex="-1"></a><span class="co">#================================================================================================</span></span>
<span id="cb341-2"><a href="michigan-consumer-survey.html#cb341-2" tabindex="-1"></a><span class="co"># Individual-Level Analysis</span></span>
<span id="cb341-3"><a href="michigan-consumer-survey.html#cb341-3" tabindex="-1"></a><span class="co">#================================================================================================</span></span>
<span id="cb341-4"><a href="michigan-consumer-survey.html#cb341-4" tabindex="-1"></a><span class="co"># Load packages</span></span>
<span id="cb341-5"><a href="michigan-consumer-survey.html#cb341-5" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</span>
<span id="cb341-6"><a href="michigan-consumer-survey.html#cb341-6" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ggplot2&quot;</span>)</span>
<span id="cb341-7"><a href="michigan-consumer-survey.html#cb341-7" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;quantmod&quot;</span>)</span>
<span id="cb341-8"><a href="michigan-consumer-survey.html#cb341-8" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;lubridate&quot;</span>)</span>
<span id="cb341-9"><a href="michigan-consumer-survey.html#cb341-9" tabindex="-1"></a></span>
<span id="cb341-10"><a href="michigan-consumer-survey.html#cb341-10" tabindex="-1"></a><span class="co"># Colorblind-friendly Figure Style</span></span>
<span id="cb341-11"><a href="michigan-consumer-survey.html#cb341-11" tabindex="-1"></a>cb_col <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;#000000&quot;</span>,<span class="st">&quot;#004949&quot;</span>,<span class="st">&quot;#009292&quot;</span>,<span class="st">&quot;#ff6db6&quot;</span>,<span class="st">&quot;#ffb6db&quot;</span>,</span>
<span id="cb341-12"><a href="michigan-consumer-survey.html#cb341-12" tabindex="-1"></a>            <span class="st">&quot;#490092&quot;</span>,<span class="st">&quot;#006ddb&quot;</span>,<span class="st">&quot;#b66dff&quot;</span>,<span class="st">&quot;#6db6ff&quot;</span>,<span class="st">&quot;#b6dbff&quot;</span>,</span>
<span id="cb341-13"><a href="michigan-consumer-survey.html#cb341-13" tabindex="-1"></a>            <span class="st">&quot;#920000&quot;</span>,<span class="st">&quot;#924900&quot;</span>,<span class="st">&quot;#db6d00&quot;</span>,<span class="st">&quot;#24ff24&quot;</span>,<span class="st">&quot;#ffff6d&quot;</span>)</span>
<span id="cb341-14"><a href="michigan-consumer-survey.html#cb341-14" tabindex="-1"></a>fig_style <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb341-15"><a href="michigan-consumer-survey.html#cb341-15" tabindex="-1"></a>fig_style<span class="sc">$</span>color <span class="ot">&lt;-</span> cb_col[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">9</span>, <span class="dv">6</span>, <span class="dv">12</span>, <span class="dv">2</span>, <span class="dv">11</span>, <span class="dv">13</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">14</span>, <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">100</span>))]</span>
<span id="cb341-16"><a href="michigan-consumer-survey.html#cb341-16" tabindex="-1"></a>fig_style<span class="sc">$</span>alpha <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, .<span class="dv">8</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="fu">rep</span>(.<span class="dv">5</span>, <span class="dv">100</span>))</span>
<span id="cb341-17"><a href="michigan-consumer-survey.html#cb341-17" tabindex="-1"></a>fig_style<span class="sc">$</span>linetype <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">100</span>)</span>
<span id="cb341-18"><a href="michigan-consumer-survey.html#cb341-18" tabindex="-1"></a>fig_style<span class="sc">$</span>size <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">7</span>, .<span class="dv">9</span>, .<span class="dv">7</span>, <span class="fl">1.3</span>, .<span class="dv">4</span>, <span class="dv">1</span>, .<span class="dv">4</span>, <span class="fl">1.3</span>, .<span class="dv">7</span>, <span class="dv">1</span>, <span class="fu">rep</span>(.<span class="dv">7</span>, <span class="dv">100</span>))</span>
<span id="cb341-19"><a href="michigan-consumer-survey.html#cb341-19" tabindex="-1"></a></span>
<span id="cb341-20"><a href="michigan-consumer-survey.html#cb341-20" tabindex="-1"></a><span class="co"># Load data</span></span>
<span id="cb341-21"><a href="michigan-consumer-survey.html#cb341-21" tabindex="-1"></a>CS <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;downloads/CS.rds&quot;</span>)</span>
<span id="cb341-22"><a href="michigan-consumer-survey.html#cb341-22" tabindex="-1"></a></span>
<span id="cb341-23"><a href="michigan-consumer-survey.html#cb341-23" tabindex="-1"></a><span class="co"># Input</span></span>
<span id="cb341-24"><a href="michigan-consumer-survey.html#cb341-24" tabindex="-1"></a>cs_select <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;PAGO&quot;</span>, <span class="st">&quot;PEXP&quot;</span>, <span class="st">&quot;BUS12&quot;</span>, <span class="st">&quot;BUS5&quot;</span>, <span class="st">&quot;DUR&quot;</span>)</span>
<span id="cb341-25"><a href="michigan-consumer-survey.html#cb341-25" tabindex="-1"></a></span>
<span id="cb341-26"><a href="michigan-consumer-survey.html#cb341-26" tabindex="-1"></a><span class="co"># Extract relevant data</span></span>
<span id="cb341-27"><a href="michigan-consumer-survey.html#cb341-27" tabindex="-1"></a>cs_CS <span class="ot">&lt;-</span> CS <span class="sc">%&gt;%</span> </span>
<span id="cb341-28"><a href="michigan-consumer-survey.html#cb341-28" tabindex="-1"></a>    <span class="fu">filter</span>(variable <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;R&quot;</span>, <span class="st">&quot;DATE&quot;</span>, cs_select))</span>
<span id="cb341-29"><a href="michigan-consumer-survey.html#cb341-29" tabindex="-1"></a></span>
<span id="cb341-30"><a href="michigan-consumer-survey.html#cb341-30" tabindex="-1"></a><span class="co"># Normalize answers across variables</span></span>
<span id="cb341-31"><a href="michigan-consumer-survey.html#cb341-31" tabindex="-1"></a>cs_CS <span class="ot">&lt;-</span> cs_CS <span class="sc">%&gt;%</span></span>
<span id="cb341-32"><a href="michigan-consumer-survey.html#cb341-32" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">category =</span> <span class="fu">factor</span>(value_cat, </span>
<span id="cb341-33"><a href="michigan-consumer-survey.html#cb341-33" tabindex="-1"></a>                             <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>,</span>
<span id="cb341-34"><a href="michigan-consumer-survey.html#cb341-34" tabindex="-1"></a>                                        <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">98</span>, <span class="dv">99</span>), </span>
<span id="cb341-35"><a href="michigan-consumer-survey.html#cb341-35" tabindex="-1"></a>                             <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Bad&quot;</span>, <span class="st">&quot;Bad&quot;</span>, <span class="st">&quot;Same&quot;</span>, <span class="st">&quot;Good&quot;</span>, <span class="st">&quot;Good&quot;</span>,  </span>
<span id="cb341-36"><a href="michigan-consumer-survey.html#cb341-36" tabindex="-1"></a>                                        <span class="st">&quot;Don&#39;t Know&quot;</span>, <span class="st">&quot;Missing&quot;</span>, <span class="st">&quot;Don&#39;t Know&quot;</span>, <span class="st">&quot;Missing&quot;</span>),</span>
<span id="cb341-37"><a href="michigan-consumer-survey.html#cb341-37" tabindex="-1"></a>                             <span class="at">ordered =</span> <span class="cn">TRUE</span>))</span>
<span id="cb341-38"><a href="michigan-consumer-survey.html#cb341-38" tabindex="-1"></a></span>
<span id="cb341-39"><a href="michigan-consumer-survey.html#cb341-39" tabindex="-1"></a><span class="co"># Select specific dates</span></span>
<span id="cb341-40"><a href="michigan-consumer-survey.html#cb341-40" tabindex="-1"></a>date_now <span class="ot">&lt;-</span> <span class="fu">max</span>(cs_CS<span class="sc">$</span>DATE)</span>
<span id="cb341-41"><a href="michigan-consumer-survey.html#cb341-41" tabindex="-1"></a>recent_dates <span class="ot">&lt;-</span> <span class="fu">add_with_rollback</span>(date_now, <span class="sc">-</span> <span class="fu">c</span>(<span class="fu">months</span>(<span class="dv">0</span>), <span class="fu">months</span>(<span class="dv">6</span>), <span class="fu">months</span>(<span class="dv">12</span>)))</span>
<span id="cb341-42"><a href="michigan-consumer-survey.html#cb341-42" tabindex="-1"></a></span>
<span id="cb341-43"><a href="michigan-consumer-survey.html#cb341-43" tabindex="-1"></a><span class="co"># Aggregation</span></span>
<span id="cb341-44"><a href="michigan-consumer-survey.html#cb341-44" tabindex="-1"></a>cs_freq <span class="ot">&lt;-</span> cs_CS <span class="sc">%&gt;%</span></span>
<span id="cb341-45"><a href="michigan-consumer-survey.html#cb341-45" tabindex="-1"></a>    <span class="fu">group_by</span>(variable, category) <span class="sc">%&gt;%</span> </span>
<span id="cb341-46"><a href="michigan-consumer-survey.html#cb341-46" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">sum</span>(WT), </span>
<span id="cb341-47"><a href="michigan-consumer-survey.html#cb341-47" tabindex="-1"></a>              <span class="at">n_now =</span> <span class="fu">sum</span>(WT[DATE <span class="sc">==</span> date_now]), </span>
<span id="cb341-48"><a href="michigan-consumer-survey.html#cb341-48" tabindex="-1"></a>              <span class="at">n_prev =</span> <span class="fu">sum</span>(WT[<span class="fu">format</span>(DATE, <span class="st">&quot;%Y&quot;</span>) <span class="sc">==</span> <span class="fu">format</span>(date_now, <span class="st">&quot;%Y&quot;</span>)]),</span>
<span id="cb341-49"><a href="michigan-consumer-survey.html#cb341-49" tabindex="-1"></a>              <span class="at">n_prev2 =</span> <span class="fu">sum</span>(WT[<span class="fu">format</span>(DATE, <span class="st">&quot;%Y&quot;</span>) <span class="sc">%in%</span> </span>
<span id="cb341-50"><a href="michigan-consumer-survey.html#cb341-50" tabindex="-1"></a>                                   <span class="fu">as.character</span>(<span class="fu">as.numeric</span>(<span class="fu">format</span>(date_now, <span class="st">&quot;%Y&quot;</span>)) <span class="sc">-</span> (<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>))])) <span class="sc">%&gt;%</span> </span>
<span id="cb341-51"><a href="michigan-consumer-survey.html#cb341-51" tabindex="-1"></a>    <span class="fu">ungroup</span>(category) <span class="sc">%&gt;%</span> </span>
<span id="cb341-52"><a href="michigan-consumer-survey.html#cb341-52" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">category =</span> category, </span>
<span id="cb341-53"><a href="michigan-consumer-survey.html#cb341-53" tabindex="-1"></a>              <span class="at">freq =</span> <span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n),</span>
<span id="cb341-54"><a href="michigan-consumer-survey.html#cb341-54" tabindex="-1"></a>              <span class="at">freq_now =</span> <span class="dv">100</span> <span class="sc">*</span> n_now <span class="sc">/</span> <span class="fu">sum</span>(n_now), </span>
<span id="cb341-55"><a href="michigan-consumer-survey.html#cb341-55" tabindex="-1"></a>              <span class="at">freq_prev =</span> <span class="dv">100</span> <span class="sc">*</span> n_prev <span class="sc">/</span> <span class="fu">sum</span>(n_prev), </span>
<span id="cb341-56"><a href="michigan-consumer-survey.html#cb341-56" tabindex="-1"></a>              <span class="at">freq_prev2 =</span> <span class="dv">100</span> <span class="sc">*</span> n_prev2 <span class="sc">/</span> <span class="fu">sum</span>(n_prev2)) <span class="sc">%&gt;%</span> </span>
<span id="cb341-57"><a href="michigan-consumer-survey.html#cb341-57" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb341-58"><a href="michigan-consumer-survey.html#cb341-58" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(<span class="st">&quot;variable&quot;</span>, <span class="st">&quot;category&quot;</span>), <span class="at">names_to =</span> <span class="st">&quot;date&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;freq&quot;</span>)</span>
<span id="cb341-59"><a href="michigan-consumer-survey.html#cb341-59" tabindex="-1"></a></span>
<span id="cb341-60"><a href="michigan-consumer-survey.html#cb341-60" tabindex="-1"></a><span class="co"># Labeling</span></span>
<span id="cb341-61"><a href="michigan-consumer-survey.html#cb341-61" tabindex="-1"></a>cs_freq <span class="ot">&lt;-</span> cs_freq <span class="sc">%&gt;%</span> </span>
<span id="cb341-62"><a href="michigan-consumer-survey.html#cb341-62" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">factor</span>(date, <span class="at">levels =</span> <span class="fu">rev</span>(<span class="fu">c</span>(<span class="st">&quot;freq&quot;</span>, <span class="st">&quot;freq_prev2&quot;</span>, <span class="st">&quot;freq_prev&quot;</span>, <span class="st">&quot;freq_now&quot;</span>)),</span>
<span id="cb341-63"><a href="michigan-consumer-survey.html#cb341-63" tabindex="-1"></a>                         <span class="at">labels =</span> <span class="fu">rev</span>(<span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&quot;1978&quot;</span>, <span class="st">&quot; - &quot;</span>, <span class="fu">format</span>(date_now, <span class="st">&quot;%Y&quot;</span>)),</span>
<span id="cb341-64"><a href="michigan-consumer-survey.html#cb341-64" tabindex="-1"></a>                                        <span class="fu">paste0</span>(<span class="fu">as.numeric</span>(<span class="fu">format</span>(date_now, <span class="st">&quot;%Y&quot;</span>)) <span class="sc">-</span> <span class="dv">2</span>, <span class="st">&quot; - &quot;</span>, </span>
<span id="cb341-65"><a href="michigan-consumer-survey.html#cb341-65" tabindex="-1"></a>                                               <span class="fu">format</span>(date_now, <span class="st">&quot;%Y&quot;</span>)),</span>
<span id="cb341-66"><a href="michigan-consumer-survey.html#cb341-66" tabindex="-1"></a>                                        <span class="fu">paste0</span>(<span class="st">&quot;Jan - &quot;</span>, <span class="fu">format</span>(date_now, <span class="st">&quot;%b &quot;</span>), <span class="fu">format</span>(date_now, <span class="st">&quot;%Y&quot;</span>)),</span>
<span id="cb341-67"><a href="michigan-consumer-survey.html#cb341-67" tabindex="-1"></a>                                        <span class="fu">format</span>(date_now, <span class="st">&quot;%b %Y&quot;</span>))),</span>
<span id="cb341-68"><a href="michigan-consumer-survey.html#cb341-68" tabindex="-1"></a>                         <span class="at">ordered =</span> <span class="cn">TRUE</span>))</span>
<span id="cb341-69"><a href="michigan-consumer-survey.html#cb341-69" tabindex="-1"></a></span>
<span id="cb341-70"><a href="michigan-consumer-survey.html#cb341-70" tabindex="-1"></a></span>
<span id="cb341-71"><a href="michigan-consumer-survey.html#cb341-71" tabindex="-1"></a><span class="co"># Make plot</span></span>
<span id="cb341-72"><a href="michigan-consumer-survey.html#cb341-72" tabindex="-1"></a>cross_plot <span class="ot">&lt;-</span> cs_freq <span class="sc">%&gt;%</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> freq, <span class="at">y =</span> date, <span class="at">fill =</span> category))<span class="sc">+</span></span>
<span id="cb341-73"><a href="michigan-consumer-survey.html#cb341-73" tabindex="-1"></a>    <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">reverse =</span> <span class="cn">TRUE</span>))<span class="sc">+</span></span>
<span id="cb341-74"><a href="michigan-consumer-survey.html#cb341-74" tabindex="-1"></a>    <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb341-75"><a href="michigan-consumer-survey.html#cb341-75" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">values =</span> fig_style<span class="sc">$</span>color)<span class="sc">+</span></span>
<span id="cb341-76"><a href="michigan-consumer-survey.html#cb341-76" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(variable), <span class="at">switch =</span> <span class="st">&quot;both&quot;</span>)<span class="sc">+</span></span>
<span id="cb341-77"><a href="michigan-consumer-survey.html#cb341-77" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Share of Responses in %&quot;</span>, <span class="at">y =</span> <span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb341-78"><a href="michigan-consumer-survey.html#cb341-78" tabindex="-1"></a>    <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb341-79"><a href="michigan-consumer-survey.html#cb341-79" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb341-80"><a href="michigan-consumer-survey.html#cb341-80" tabindex="-1"></a>          <span class="at">legend.key.size =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">&quot;cm&quot;</span>))</span>
<span id="cb341-81"><a href="michigan-consumer-survey.html#cb341-81" tabindex="-1"></a></span>
<span id="cb341-82"><a href="michigan-consumer-survey.html#cb341-82" tabindex="-1"></a><span class="co"># Show plot</span></span>
<span id="cb341-83"><a href="michigan-consumer-survey.html#cb341-83" tabindex="-1"></a>cross_plot</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-145-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="michigan-consumer-survey.html#cb342-1" tabindex="-1"></a><span class="co"># Save plot</span></span>
<span id="cb342-2"><a href="michigan-consumer-survey.html#cb342-2" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="fu">file.path</span>(<span class="st">&quot;downloads&quot;</span>, <span class="st">&quot;figures&quot;</span>), <span class="at">showWarnings =</span> <span class="cn">FALSE</span>)</span>
<span id="cb342-3"><a href="michigan-consumer-survey.html#cb342-3" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">file.path</span>(<span class="st">&quot;downloads&quot;</span>, <span class="st">&quot;figures&quot;</span>, <span class="st">&quot;cs_crossplot.png&quot;</span>), </span>
<span id="cb342-4"><a href="michigan-consumer-survey.html#cb342-4" tabindex="-1"></a>       <span class="at">plot =</span> cross_plot, <span class="at">width =</span> <span class="dv">5</span>, <span class="at">height =</span> <span class="dv">4</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span></code></pre></div>
</div>
<div id="replicate-ics" class="section level2 hasAnchor" number="20.7">
<h2><span class="header-section-number">20.7</span> Replicate ICS<a href="michigan-consumer-survey.html#replicate-ics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s use the individual-level data to reproduce the Index of Consumer Sentiment (ICS). You can tailor this process to create any index based on any set of questions.</p>
<p>But first, let’s define the recession shade function, as discussed in Chapter <a href="data-categorization.html#time-series-data">11.6.2</a>:</p>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="michigan-consumer-survey.html#cb343-1" tabindex="-1"></a><span class="co">#--------------------------------</span></span>
<span id="cb343-2"><a href="michigan-consumer-survey.html#cb343-2" tabindex="-1"></a><span class="co"># Recession shades</span></span>
<span id="cb343-3"><a href="michigan-consumer-survey.html#cb343-3" tabindex="-1"></a><span class="co">#--------------------------------</span></span>
<span id="cb343-4"><a href="michigan-consumer-survey.html#cb343-4" tabindex="-1"></a><span class="co"># Load NBER based recession indicators for the United States</span></span>
<span id="cb343-5"><a href="michigan-consumer-survey.html#cb343-5" tabindex="-1"></a>quantmod<span class="sc">::</span><span class="fu">getSymbols</span>(<span class="st">&quot;USRECM&quot;</span>, <span class="at">src =</span> <span class="st">&quot;FRED&quot;</span>)</span>
<span id="cb343-6"><a href="michigan-consumer-survey.html#cb343-6" tabindex="-1"></a></span>
<span id="cb343-7"><a href="michigan-consumer-survey.html#cb343-7" tabindex="-1"></a><span class="co"># Create a data frame with dates referring to start and end of recessions</span></span>
<span id="cb343-8"><a href="michigan-consumer-survey.html#cb343-8" tabindex="-1"></a>REC <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">index =</span> zoo<span class="sc">::</span><span class="fu">index</span>(USRECM), <span class="at">USRECM =</span> zoo<span class="sc">::</span><span class="fu">coredata</span>(USRECM))</span>
<span id="cb343-9"><a href="michigan-consumer-survey.html#cb343-9" tabindex="-1"></a>REC <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">list</span>(REC[<span class="dv">1</span>, <span class="st">&quot;index&quot;</span>], <span class="dv">0</span>), REC, <span class="fu">list</span>(REC[<span class="fu">nrow</span>(REC), <span class="st">&quot;index&quot;</span>], <span class="dv">0</span>))</span>
<span id="cb343-10"><a href="michigan-consumer-survey.html#cb343-10" tabindex="-1"></a>REC<span class="sc">$</span>dUSRECM <span class="ot">&lt;-</span> REC<span class="sc">$</span>USRECM <span class="sc">-</span> <span class="fu">c</span>(<span class="cn">NA</span>, REC<span class="sc">$</span>USRECM[<span class="sc">-</span><span class="fu">nrow</span>(REC)])</span>
<span id="cb343-11"><a href="michigan-consumer-survey.html#cb343-11" tabindex="-1"></a>REC <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">rec_start =</span> REC<span class="sc">$</span>index[REC<span class="sc">$</span>dUSRECM <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(REC<span class="sc">$</span>dUSRECM)],</span>
<span id="cb343-12"><a href="michigan-consumer-survey.html#cb343-12" tabindex="-1"></a>                  <span class="at">rec_end =</span> REC<span class="sc">$</span>index[REC<span class="sc">$</span>dUSRECM <span class="sc">==</span> <span class="sc">-</span><span class="dv">1</span> <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(REC<span class="sc">$</span>dUSRECM)])</span>
<span id="cb343-13"><a href="michigan-consumer-survey.html#cb343-13" tabindex="-1"></a></span>
<span id="cb343-14"><a href="michigan-consumer-survey.html#cb343-14" tabindex="-1"></a><span class="co"># Add a ggplot() layer that draws rectangles for those recession periods</span></span>
<span id="cb343-15"><a href="michigan-consumer-survey.html#cb343-15" tabindex="-1"></a>geom_recession_shades <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fu">min</span>(REC<span class="sc">$</span>rec_start), <span class="fu">max</span>(REC<span class="sc">$</span>rec_end))){</span>
<span id="cb343-16"><a href="michigan-consumer-survey.html#cb343-16" tabindex="-1"></a>    <span class="fu">geom_rect</span>(<span class="at">data =</span> REC[REC<span class="sc">$</span>rec_start <span class="sc">&gt;=</span> xlim[<span class="dv">1</span>] <span class="sc">&amp;</span> REC<span class="sc">$</span>rec_end <span class="sc">&lt;=</span> xlim[<span class="dv">2</span>], ], </span>
<span id="cb343-17"><a href="michigan-consumer-survey.html#cb343-17" tabindex="-1"></a>              <span class="at">inherit.aes =</span> <span class="cn">FALSE</span>, </span>
<span id="cb343-18"><a href="michigan-consumer-survey.html#cb343-18" tabindex="-1"></a>              <span class="fu">aes</span>(<span class="at">xmin =</span> rec_start, <span class="at">xmax =</span> rec_end, <span class="at">ymin =</span> <span class="sc">-</span><span class="cn">Inf</span>, <span class="at">ymax =</span> <span class="sc">+</span><span class="cn">Inf</span>),</span>
<span id="cb343-19"><a href="michigan-consumer-survey.html#cb343-19" tabindex="-1"></a>              <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> .<span class="dv">15</span>)</span>
<span id="cb343-20"><a href="michigan-consumer-survey.html#cb343-20" tabindex="-1"></a>}</span></code></pre></div>
<p>Now construct the ICS:</p>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="michigan-consumer-survey.html#cb344-1" tabindex="-1"></a><span class="co">#================================================================================================</span></span>
<span id="cb344-2"><a href="michigan-consumer-survey.html#cb344-2" tabindex="-1"></a><span class="co"># Construct the Index of Consumer Sentiment</span></span>
<span id="cb344-3"><a href="michigan-consumer-survey.html#cb344-3" tabindex="-1"></a><span class="co">#================================================================================================</span></span>
<span id="cb344-4"><a href="michigan-consumer-survey.html#cb344-4" tabindex="-1"></a><span class="co"># Input</span></span>
<span id="cb344-5"><a href="michigan-consumer-survey.html#cb344-5" tabindex="-1"></a>ics_select <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;PAGO&quot;</span>, <span class="st">&quot;PEXP&quot;</span>, <span class="st">&quot;BUS12&quot;</span>, <span class="st">&quot;BUS5&quot;</span>, <span class="st">&quot;DUR&quot;</span>)</span>
<span id="cb344-6"><a href="michigan-consumer-survey.html#cb344-6" tabindex="-1"></a>ics_variables <span class="ot">&lt;-</span> <span class="fu">attr</span>(CS, <span class="st">&quot;labels&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb344-7"><a href="michigan-consumer-survey.html#cb344-7" tabindex="-1"></a>    <span class="fu">select</span>(variable, label_var, question) <span class="sc">%&gt;%</span> </span>
<span id="cb344-8"><a href="michigan-consumer-survey.html#cb344-8" tabindex="-1"></a>    <span class="fu">distinct</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb344-9"><a href="michigan-consumer-survey.html#cb344-9" tabindex="-1"></a>    <span class="fu">filter</span>(variable <span class="sc">%in%</span> cs_select) <span class="sc">%&gt;%</span> </span>
<span id="cb344-10"><a href="michigan-consumer-survey.html#cb344-10" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">variable =</span> <span class="fu">factor</span>(<span class="at">x =</span> variable, <span class="at">levels =</span> cs_select, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb344-11"><a href="michigan-consumer-survey.html#cb344-11" tabindex="-1"></a>    <span class="fu">arrange</span>(variable)</span>
<span id="cb344-12"><a href="michigan-consumer-survey.html#cb344-12" tabindex="-1"></a></span>
<span id="cb344-13"><a href="michigan-consumer-survey.html#cb344-13" tabindex="-1"></a><span class="co"># Standardize variables</span></span>
<span id="cb344-14"><a href="michigan-consumer-survey.html#cb344-14" tabindex="-1"></a>ics_data <span class="ot">&lt;-</span> CS <span class="sc">%&gt;%</span></span>
<span id="cb344-15"><a href="michigan-consumer-survey.html#cb344-15" tabindex="-1"></a>    <span class="fu">filter</span>(variable <span class="sc">%in%</span> ics_variables<span class="sc">$</span>variable) <span class="sc">%&gt;%</span></span>
<span id="cb344-16"><a href="michigan-consumer-survey.html#cb344-16" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">category =</span> <span class="fu">factor</span>(value_cat, </span>
<span id="cb344-17"><a href="michigan-consumer-survey.html#cb344-17" tabindex="-1"></a>                             <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>,</span>
<span id="cb344-18"><a href="michigan-consumer-survey.html#cb344-18" tabindex="-1"></a>                                        <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">98</span>, <span class="dv">99</span>), </span>
<span id="cb344-19"><a href="michigan-consumer-survey.html#cb344-19" tabindex="-1"></a>                             <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;Bad&quot;</span>, <span class="st">&quot;Bad&quot;</span>, <span class="st">&quot;Same&quot;</span>, <span class="st">&quot;Good&quot;</span>, <span class="st">&quot;Good&quot;</span>,  </span>
<span id="cb344-20"><a href="michigan-consumer-survey.html#cb344-20" tabindex="-1"></a>                                        <span class="st">&quot;Don&#39;t Know&quot;</span>, <span class="st">&quot;Missing&quot;</span>, <span class="st">&quot;Don&#39;t Know&quot;</span>, <span class="st">&quot;Missing&quot;</span>),</span>
<span id="cb344-21"><a href="michigan-consumer-survey.html#cb344-21" tabindex="-1"></a>                             <span class="at">ordered =</span> <span class="cn">TRUE</span>))</span>
<span id="cb344-22"><a href="michigan-consumer-survey.html#cb344-22" tabindex="-1"></a></span>
<span id="cb344-23"><a href="michigan-consumer-survey.html#cb344-23" tabindex="-1"></a><span class="co"># Aggregate</span></span>
<span id="cb344-24"><a href="michigan-consumer-survey.html#cb344-24" tabindex="-1"></a>ics_data <span class="ot">&lt;-</span> ics_data <span class="sc">%&gt;%</span> <span class="fu">count</span>(DATE, variable, category, <span class="at">wt =</span> WT) <span class="sc">%&gt;%</span></span>
<span id="cb344-25"><a href="michigan-consumer-survey.html#cb344-25" tabindex="-1"></a>    <span class="fu">group_by</span>(DATE, variable) <span class="sc">%&gt;%</span> </span>
<span id="cb344-26"><a href="michigan-consumer-survey.html#cb344-26" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">freq =</span> <span class="dv">100</span> <span class="sc">*</span> n <span class="sc">/</span> <span class="fu">sum</span>(n))</span>
<span id="cb344-27"><a href="michigan-consumer-survey.html#cb344-27" tabindex="-1"></a></span>
<span id="cb344-28"><a href="michigan-consumer-survey.html#cb344-28" tabindex="-1"></a><span class="co"># Variable labels</span></span>
<span id="cb344-29"><a href="michigan-consumer-survey.html#cb344-29" tabindex="-1"></a>ics_data <span class="ot">&lt;-</span> ics_data <span class="sc">%&gt;%</span> </span>
<span id="cb344-30"><a href="michigan-consumer-survey.html#cb344-30" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">label_var =</span> <span class="fu">factor</span>(<span class="at">x =</span> variable, </span>
<span id="cb344-31"><a href="michigan-consumer-survey.html#cb344-31" tabindex="-1"></a>                          <span class="at">levels =</span> ics_variables<span class="sc">$</span>variable, </span>
<span id="cb344-32"><a href="michigan-consumer-survey.html#cb344-32" tabindex="-1"></a>                          <span class="at">labels =</span> ics_variables<span class="sc">$</span>label_var,</span>
<span id="cb344-33"><a href="michigan-consumer-survey.html#cb344-33" tabindex="-1"></a>                          <span class="at">ordered =</span> <span class="cn">TRUE</span>))</span>
<span id="cb344-34"><a href="michigan-consumer-survey.html#cb344-34" tabindex="-1"></a></span>
<span id="cb344-35"><a href="michigan-consumer-survey.html#cb344-35" tabindex="-1"></a><span class="co"># Compute scores</span></span>
<span id="cb344-36"><a href="michigan-consumer-survey.html#cb344-36" tabindex="-1"></a>ics_data <span class="ot">&lt;-</span> ics_data <span class="sc">%&gt;%</span> </span>
<span id="cb344-37"><a href="michigan-consumer-survey.html#cb344-37" tabindex="-1"></a>    <span class="fu">group_by</span>(DATE, variable, label_var) <span class="sc">%&gt;%</span> </span>
<span id="cb344-38"><a href="michigan-consumer-survey.html#cb344-38" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">freq =</span> <span class="dv">100</span> <span class="sc">+</span> freq[category <span class="sc">==</span> <span class="st">&quot;Good&quot;</span>] <span class="sc">-</span> freq[category <span class="sc">==</span> <span class="st">&quot;Bad&quot;</span>], <span class="at">category =</span> <span class="st">&quot;Score&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb344-39"><a href="michigan-consumer-survey.html#cb344-39" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb344-40"><a href="michigan-consumer-survey.html#cb344-40" tabindex="-1"></a>    <span class="fu">bind_rows</span>(ics_data) <span class="sc">%&gt;%</span> </span>
<span id="cb344-41"><a href="michigan-consumer-survey.html#cb344-41" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">category =</span> <span class="fu">factor</span>(category, <span class="at">levels =</span> <span class="fu">c</span>(<span class="fu">levels</span>(ics_data<span class="sc">$</span>category), <span class="st">&quot;Score&quot;</span>), <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb344-42"><a href="michigan-consumer-survey.html#cb344-42" tabindex="-1"></a>    <span class="fu">arrange</span>(DATE, variable, category)</span>
<span id="cb344-43"><a href="michigan-consumer-survey.html#cb344-43" tabindex="-1"></a></span>
<span id="cb344-44"><a href="michigan-consumer-survey.html#cb344-44" tabindex="-1"></a><span class="co"># Compute consumer indexes</span></span>
<span id="cb344-45"><a href="michigan-consumer-survey.html#cb344-45" tabindex="-1"></a>ics_indexes <span class="ot">&lt;-</span> ics_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;Score&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb344-46"><a href="michigan-consumer-survey.html#cb344-46" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">intercept =</span> <span class="fu">ifelse</span>(DATE <span class="sc">&lt;=</span> <span class="fu">as.Date</span>(<span class="st">&quot;1981-11-01&quot;</span>), <span class="fl">2.7</span>, <span class="dv">2</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb344-47"><a href="michigan-consumer-survey.html#cb344-47" tabindex="-1"></a>    <span class="fu">group_by</span>(DATE) <span class="sc">%&gt;%</span> </span>
<span id="cb344-48"><a href="michigan-consumer-survey.html#cb344-48" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">ICC =</span> <span class="fu">first</span>(intercept) <span class="sc">+</span> <span class="fu">sum</span>(freq <span class="sc">*</span> (variable <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;PAGO&quot;</span>, <span class="st">&quot;DUR&quot;</span>)) <span class="sc">/</span> <span class="fl">2.6424</span>),</span>
<span id="cb344-49"><a href="michigan-consumer-survey.html#cb344-49" tabindex="-1"></a>              <span class="at">ICE =</span> <span class="fu">first</span>(intercept) <span class="sc">+</span> <span class="fu">sum</span>(freq <span class="sc">*</span> (variable <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;PEXP&quot;</span>, <span class="st">&quot;BUS12&quot;</span>, <span class="st">&quot;BUS5&quot;</span>)) <span class="sc">/</span> <span class="fl">4.1134</span>),</span>
<span id="cb344-50"><a href="michigan-consumer-survey.html#cb344-50" tabindex="-1"></a>              <span class="at">ICS =</span> <span class="fu">first</span>(intercept) <span class="sc">+</span> <span class="fu">sum</span>(freq) <span class="sc">/</span> <span class="fl">6.7558</span>)</span>
<span id="cb344-51"><a href="michigan-consumer-survey.html#cb344-51" tabindex="-1"></a></span>
<span id="cb344-52"><a href="michigan-consumer-survey.html#cb344-52" tabindex="-1"></a><span class="co"># Check if ICS is correct</span></span>
<span id="cb344-53"><a href="michigan-consumer-survey.html#cb344-53" tabindex="-1"></a>UMCSENT <span class="ot">&lt;-</span> quantmod<span class="sc">::</span><span class="fu">getSymbols</span>(<span class="st">&quot;UMCSENT&quot;</span>, <span class="at">src =</span> <span class="st">&quot;FRED&quot;</span>, <span class="at">auto.assign =</span> <span class="cn">FALSE</span>)</span>
<span id="cb344-54"><a href="michigan-consumer-survey.html#cb344-54" tabindex="-1"></a>plot_FRED <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">DATE =</span> <span class="fu">index</span>(UMCSENT), <span class="at">ICS_official =</span> <span class="fu">as.numeric</span>(UMCSENT)) <span class="sc">%&gt;%</span> </span>
<span id="cb344-55"><a href="michigan-consumer-survey.html#cb344-55" tabindex="-1"></a>    <span class="fu">filter</span>(DATE <span class="sc">&gt;=</span> <span class="fu">min</span>(ics_indexes<span class="sc">$</span>DATE)) <span class="sc">%&gt;%</span> </span>
<span id="cb344-56"><a href="michigan-consumer-survey.html#cb344-56" tabindex="-1"></a>    <span class="fu">left_join</span>(ics_indexes, <span class="at">by =</span> <span class="st">&quot;DATE&quot;</span>, <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">&quot;_official&quot;</span>, <span class="st">&quot;_self&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb344-57"><a href="michigan-consumer-survey.html#cb344-57" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">diff =</span> ICS_official <span class="sc">-</span> ICS)<span class="sc">%&gt;%</span> </span>
<span id="cb344-58"><a href="michigan-consumer-survey.html#cb344-58" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> DATE, <span class="at">y =</span> diff))<span class="sc">+</span></span>
<span id="cb344-59"><a href="michigan-consumer-survey.html#cb344-59" tabindex="-1"></a>    <span class="fu">geom_line</span>()</span>
<span id="cb344-60"><a href="michigan-consumer-survey.html#cb344-60" tabindex="-1"></a>plot_FRED</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-147-1.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="michigan-consumer-survey.html#cb345-1" tabindex="-1"></a><span class="co"># Save plot</span></span>
<span id="cb345-2"><a href="michigan-consumer-survey.html#cb345-2" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="fu">file.path</span>(<span class="st">&quot;downloads&quot;</span>, <span class="st">&quot;figures&quot;</span>), <span class="at">showWarnings =</span> <span class="cn">FALSE</span>)</span>
<span id="cb345-3"><a href="michigan-consumer-survey.html#cb345-3" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">file.path</span>(<span class="st">&quot;downloads&quot;</span>, <span class="st">&quot;figures&quot;</span>, <span class="st">&quot;FRED_comparison.png&quot;</span>), </span>
<span id="cb345-4"><a href="michigan-consumer-survey.html#cb345-4" tabindex="-1"></a>       <span class="at">plot =</span> plot_FRED, <span class="at">width =</span> <span class="dv">12</span>, <span class="at">height =</span> <span class="dv">6</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span>
<span id="cb345-5"><a href="michigan-consumer-survey.html#cb345-5" tabindex="-1"></a></span>
<span id="cb345-6"><a href="michigan-consumer-survey.html#cb345-6" tabindex="-1"></a><span class="co"># Plot</span></span>
<span id="cb345-7"><a href="michigan-consumer-survey.html#cb345-7" tabindex="-1"></a>ts_plot <span class="ot">&lt;-</span> ics_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(category <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Good&quot;</span>, <span class="st">&quot;Bad&quot;</span>, <span class="st">&quot;Score&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb345-8"><a href="michigan-consumer-survey.html#cb345-8" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> DATE, <span class="at">y =</span> freq, <span class="at">col =</span> <span class="fu">paste</span>(variable, label_var, <span class="at">sep =</span> <span class="st">&quot;: &quot;</span>)))<span class="sc">+</span></span>
<span id="cb345-9"><a href="michigan-consumer-survey.html#cb345-9" tabindex="-1"></a>    <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb345-10"><a href="michigan-consumer-survey.html#cb345-10" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">name =</span> <span class="cn">NULL</span>, <span class="at">values =</span> fig_style<span class="sc">$</span>color)<span class="sc">+</span></span>
<span id="cb345-11"><a href="michigan-consumer-survey.html#cb345-11" tabindex="-1"></a>    <span class="fu">facet_grid</span>(<span class="at">rows =</span> <span class="fu">vars</span>(category), <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">switch =</span> <span class="st">&quot;both&quot;</span>)<span class="sc">+</span></span>
<span id="cb345-12"><a href="michigan-consumer-survey.html#cb345-12" tabindex="-1"></a>    <span class="fu">geom_recession_shades</span>(<span class="at">xlim =</span> <span class="fu">range</span>(ics_data<span class="sc">$</span>DATE))<span class="sc">+</span></span>
<span id="cb345-13"><a href="michigan-consumer-survey.html#cb345-13" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;                                          Share of Responses in %&quot;</span>,</span>
<span id="cb345-14"><a href="michigan-consumer-survey.html#cb345-14" tabindex="-1"></a>         <span class="at">subtitle =</span> <span class="st">&quot;Score = 100 + Good - Bad&quot;</span>)<span class="sc">+</span></span>
<span id="cb345-15"><a href="michigan-consumer-survey.html#cb345-15" tabindex="-1"></a>    <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb345-16"><a href="michigan-consumer-survey.html#cb345-16" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb345-17"><a href="michigan-consumer-survey.html#cb345-17" tabindex="-1"></a>          <span class="at">axis.title.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb345-18"><a href="michigan-consumer-survey.html#cb345-18" tabindex="-1"></a>          <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb345-19"><a href="michigan-consumer-survey.html#cb345-19" tabindex="-1"></a>          <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>),</span>
<span id="cb345-20"><a href="michigan-consumer-survey.html#cb345-20" tabindex="-1"></a>          <span class="at">legend.key.size =</span> <span class="fu">unit</span>(.<span class="dv">5</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb345-21"><a href="michigan-consumer-survey.html#cb345-21" tabindex="-1"></a>          <span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>,</span>
<span id="cb345-22"><a href="michigan-consumer-survey.html#cb345-22" tabindex="-1"></a>          <span class="at">legend.direction =</span> <span class="st">&quot;horizontal&quot;</span>,</span>
<span id="cb345-23"><a href="michigan-consumer-survey.html#cb345-23" tabindex="-1"></a>          <span class="at">legend.justification =</span> <span class="st">&quot;left&quot;</span>,</span>
<span id="cb345-24"><a href="michigan-consumer-survey.html#cb345-24" tabindex="-1"></a>          <span class="at">legend.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="dv">0</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">l =</span> <span class="sc">-</span><span class="dv">12</span>),</span>
<span id="cb345-25"><a href="michigan-consumer-survey.html#cb345-25" tabindex="-1"></a>          <span class="at">legend.box.margin =</span> <span class="fu">margin</span>(<span class="at">t =</span> <span class="sc">-</span><span class="dv">8</span>, <span class="at">r =</span> <span class="dv">0</span>, <span class="at">b =</span> <span class="dv">0</span>, <span class="at">l =</span> <span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb345-26"><a href="michigan-consumer-survey.html#cb345-26" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">alpha =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">2</span>),</span>
<span id="cb345-27"><a href="michigan-consumer-survey.html#cb345-27" tabindex="-1"></a>           <span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">2</span>),</span>
<span id="cb345-28"><a href="michigan-consumer-survey.html#cb345-28" tabindex="-1"></a>           <span class="at">fill =</span> <span class="fu">guide_legend</span>(<span class="at">ncol =</span> <span class="dv">2</span>))</span>
<span id="cb345-29"><a href="michigan-consumer-survey.html#cb345-29" tabindex="-1"></a>ts_plot</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-147-2.png" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="michigan-consumer-survey.html#cb346-1" tabindex="-1"></a><span class="co"># Save plot</span></span>
<span id="cb346-2"><a href="michigan-consumer-survey.html#cb346-2" tabindex="-1"></a><span class="fu">dir.create</span>(<span class="fu">file.path</span>(<span class="st">&quot;downloads&quot;</span>, <span class="st">&quot;figures&quot;</span>), <span class="at">showWarnings =</span> <span class="cn">FALSE</span>)</span>
<span id="cb346-3"><a href="michigan-consumer-survey.html#cb346-3" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="fu">file.path</span>(<span class="st">&quot;downloads&quot;</span>, <span class="st">&quot;figures&quot;</span>, <span class="st">&quot;ics_good_bad.png&quot;</span>), </span>
<span id="cb346-4"><a href="michigan-consumer-survey.html#cb346-4" tabindex="-1"></a>       <span class="at">plot =</span> ts_plot, <span class="at">width =</span> <span class="dv">6</span>, <span class="at">height =</span> <span class="dv">5</span>, <span class="at">dpi =</span> <span class="dv">600</span>)</span></code></pre></div>
</div>
<div id="conclusion" class="section level2 hasAnchor" number="20.8">
<h2><span class="header-section-number">20.8</span> Conclusion<a href="michigan-consumer-survey.html#conclusion" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Throughout this chapter, we have explored the Michigan Consumer Survey. This data, collected monthly, offers profound insights into consumers’ attitudes, and can serve as a valuable tool for researchers, economists, investors, and policymakers.</p>
<p>We delved into the three indices generated from this survey data - ICC, ICE, and ICS - and also discussed how to import these indices for further analysis. Beyond these existing indices, we discussed the potential for creating custom indices tailored to specific research interests or sectors of the economy.</p>
<p>An in-depth example of creating a new index from the ground up was presented with a step-by-step guide to replicating the Index of Consumer Sentiment (ICS) from individual-level data. The approach provided can be adjusted to create any index based on any set of questions.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="why-subjective-information-matters.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="real-time-and-forecaster-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": [["daer.pdf", "PDF"]],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
